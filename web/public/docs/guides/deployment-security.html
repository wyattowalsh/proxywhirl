<!DOCTYPE html>
<html lang="en" data-accent-color="violet" data-content_root="../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Deployment Security &amp; Reverse Proxy Configuration - ProxyWhirl Documentation</title><link rel="shortcut icon" href="../_static/favicon.svg"/><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="CLI Reference" href="cli-reference.html" /><link rel="prev" title="Retry &amp; Failover Guide" href="retry-failover.html" />
      <link rel="canonical" href="https://proxywhirl.readthedocs.io/guides/deployment-security.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=e1a1ceaf" />
    <link rel="stylesheet" type="text/css" href="../_static/shibuya.css?v=44020203" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link media="print" rel="stylesheet" type="text/css" href="../_static/print.css?v=20ff2c19" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=ad06e0ee" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://proxywhirl.readthedocs.io/guides/deployment-security.html"/>
  <meta property="og:title" content="Deployment Security &amp; Reverse Proxy Configuration"/>
  <meta property="og:image" content="https://proxywhirl.readthedocs.io/_static/og-image.png"/>
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:creator" content="@@wyaborern"/>
<meta name="twitter:site" content="@@wyaborern"/>
  </head>
<body>
<header class="pw-navbar">
  <div class="pw-navbar-inner">
    
    <button class="pw-navbar-sidebar-toggle js-menu" aria-controls="lside" aria-expanded="false" aria-label="Toggle navigation" type="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
    </button>

    
    <a href="/" class="pw-navbar-brand">
      <svg class="pw-navbar-logo" viewBox="0 0 100 100" aria-hidden="true">
        <defs>
          <linearGradient id="pw-logo-grad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#06b6d4"/>
            <stop offset="50%" stop-color="#3b82f6"/>
            <stop offset="100%" stop-color="#8b5cf6"/>
          </linearGradient>
        </defs>
        <circle cx="50" cy="50" r="44" fill="none" stroke="url(#pw-logo-grad)" stroke-width="6" stroke-linecap="round" stroke-dasharray="60 30"/>
        <g fill="url(#pw-logo-grad)">
          <path d="M50 18 L58 30 L52 30 L52 42 L48 42 L48 30 L42 30 Z"/>
          <path d="M82 50 L70 58 L70 52 L58 52 L58 48 L70 48 L70 42 Z"/>
          <path d="M50 82 L42 70 L48 70 L48 58 L52 58 L52 70 L58 70 Z"/>
          <path d="M18 50 L30 42 L30 48 L42 48 L42 52 L30 52 L30 58 Z"/>
        </g>
        <circle cx="50" cy="50" r="8" fill="url(#pw-logo-grad)"/>
      </svg>
      <strong>ProxyWhirl</strong>
    </a>

    
    <nav class="pw-navbar-links">
      <a href="/docs/" class="pw-navbar-link active">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        Docs
      </a>
    </nav>

    
    <div class="pw-navbar-actions">
      
      <button class="pw-navbar-btn" id="pw-theme-toggle" type="button" aria-label="Toggle theme">
        <svg class="pw-icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
        <svg class="pw-icon-moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
      </button>

      
      <a href="https://github.com/wyattowalsh/proxywhirl" class="pw-navbar-btn pw-navbar-github" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
      </a>
    </div>
  </div>
</header>

<script>
(function() {
  var toggle = document.getElementById('pw-theme-toggle');
  if (!toggle) return;
  toggle.addEventListener('click', function() {
    var isDark = document.documentElement.classList.contains('dark');
    var next = isDark ? 'light' : 'dark';
    localStorage._theme = next;
    if (typeof setColorMode === 'function') {
      setColorMode(next);
    } else {
      var html = document.documentElement;
      html.classList.remove('dark', 'light');
      html.classList.add(next);
      html.setAttribute('data-color-mode', next);
    }
  });
})();
</script>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="2"><ul class="current">
<li class="toctree-l1 _expand"><a class="reference internal" href="../getting-started/index.html">Getting Started</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#installation">Installation</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#quick-start">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#async-usage">Async Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#using-free-proxy-lists">Using Free Proxy Lists</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#rotation-strategies">Rotation Strategies</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#next-steps">Next Steps</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#for-contributors">For Contributors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/rotation-strategies.html">Rotation Strategies Quickstart</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#bootstrap-a-rotator">Bootstrap a rotator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#strategy-selector">Strategy selector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#strategy-recipes">Strategy recipes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#observe-the-pool">Observe the pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#advanced-strategies-preview">Advanced strategies (preview)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 _expand"><a class="reference internal" href="../getting-started/rotation-strategies.html">Rotation Strategies Quickstart</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/rotation-strategies.html#bootstrap-a-rotator">Bootstrap a rotator</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/rotation-strategies.html#strategy-selector">Strategy selector</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/rotation-strategies.html#strategy-recipes">Strategy recipes</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/rotation-strategies.html#observe-the-pool">Observe the pool</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/rotation-strategies.html#advanced-strategies-preview">Advanced strategies (preview)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Guides</a><ul class="current">
<li class="toctree-l2 _expand"><a class="reference internal" href="async-client.html">Async Client Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#when-to-use-async-vs-sync">When to Use Async vs Sync</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#use-asyncproxyrotator-when">Use AsyncProxyRotator when:</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#use-proxyrotator-sync-when">Use ProxyRotator (sync) when:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#initialization">Initialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#basic-initialization">Basic Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#with-initial-proxies">With Initial Proxies</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#with-custom-strategy">With Custom Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#with-custom-configuration">With Custom Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#context-manager-usage">Context Manager Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#async-context-manager-recommended">Async Context Manager (Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#manual-lifecycle-management-advanced">Manual Lifecycle Management (Advanced)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#http-request-methods">HTTP Request Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#all-http-methods">All HTTP Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#request-parameters">Request Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#proxy-management">Proxy Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#adding-proxies">Adding Proxies</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#removing-proxies">Removing Proxies</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#getting-proxy-statistics">Getting Proxy Statistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#hot-swapping-strategies">Hot-Swapping Strategies</a></li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#error-handling">Error Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#basic-exception-handling">Basic Exception Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#retry-policy-override">Retry Policy Override</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#circuit-breaker-management">Circuit Breaker Management</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#concurrent-requests-with-asyncio-gather">Concurrent Requests with asyncio.gather</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#parallel-requests-to-different-urls">Parallel Requests to Different URLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#rate-limited-concurrent-scraping">Rate-Limited Concurrent Scraping</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#production-scale-web-scraping">Production-Scale Web Scraping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#connection-pooling">Connection Pooling</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#connection-limits">Connection Limits</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#memory-management">Memory Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#performance-benchmarks">Performance Benchmarks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#asyncio-integration-patterns">Asyncio Integration Patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#with-fastapi">With FastAPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#with-aiohttp">With aiohttp</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#advanced-httpx-integration">Advanced httpx Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#with-asyncio-queue">With asyncio.Queue</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#comparison-async-vs-sync">Comparison: Async vs Sync</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#feature-parity">Feature Parity</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#key-differences">Key Differences</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#migration-example">Migration Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#best-practices-and-common-patterns">Best Practices and Common Patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#always-use-context-managers">1. Always Use Context Managers</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#use-semaphores-for-concurrency-control">2. Use Semaphores for Concurrency Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#handle-exceptions-gracefully">3. Handle Exceptions Gracefully</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#reuse-rotator-instances">4. Reuse Rotator Instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#monitor-circuit-breaker-states">5. Monitor Circuit Breaker States</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#use-appropriate-retry-policies">6. Use Appropriate Retry Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#profile-and-optimize-connection-pooling">7. Profile and Optimize Connection Pooling</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#use-strategy-hot-swapping-for-adaptive-behavior">8. Use Strategy Hot-Swapping for Adaptive Behavior</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#clean-up-resources-properly">9. Clean Up Resources Properly</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#avoid-common-pitfalls">10. Avoid Common Pitfalls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async-client.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="advanced-strategies.html">Advanced Rotation Strategies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#available-strategies">Available Strategies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#performance-based-strategy">Performance-Based Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#when-to-use">When to Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#performance-characteristics">Performance Characteristics</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#how-it-works">How It Works</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#warmup-period">Warmup Period</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#adaptation-example">Adaptation Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#success-criteria">Success Criteria</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#session-persistence-strategy">Session Persistence Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id1">When to Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id2">Performance Characteristics</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id3">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#session-lifecycle">Session Lifecycle</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#session-management">Session Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#failover-behavior">Failover Behavior</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#ttl-and-expiration">TTL and Expiration</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#lru-eviction">LRU Eviction</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id4">Success Criteria</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#geo-targeted-strategy">Geo-Targeted Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id5">When to Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id6">Performance Characteristics</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id7">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#country-codes">Country Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#filtering-logic">Filtering Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#fallback-modes">Fallback Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#secondary-selection-strategies">Secondary Selection Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#retry-integration">Retry Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id8">Success Criteria</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#cost-aware-strategy">Cost-Aware Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id9">When to Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id10">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#weight-calculation">Weight Calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#cost-threshold-filtering">Cost Threshold Filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#composite-strategy">Composite Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id11">When to Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id12">Performance Characteristics</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#architecture">Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#basic-composition">Basic Composition</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#common-patterns">Common Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#configuration-from-dict">Configuration from Dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#validation-example">Validation Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id13">Success Criteria</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#strategy-registry">Strategy Registry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#registration">Registration</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#validation">Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#listing-strategies">Listing Strategies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#selectioncontext">SelectionContext</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#fields">Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#usage-with-strategies">Usage with Strategies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#strategyconfig">StrategyConfig</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id14">Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#per-strategy-configuration">Per-Strategy Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#custom-strategy-implementation">Custom Strategy Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#implementing-the-protocol">Implementing the Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#registering-custom-strategies">Registering Custom Strategies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#strategyregistry-usage">StrategyRegistry Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#registration-and-validation">Registration and Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#strategy-validation">Strategy Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id15">Thread Safety</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#unregistering-strategies">Unregistering Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#testing-with-registry-reset">Testing with Registry Reset</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#performance-requirements">Performance Requirements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#id16">Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#choose-the-right-strategy">1. Choose the Right Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#warm-up-performance-based-strategies">2. Warm Up Performance-Based Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#monitor-session-memory">3. Monitor Session Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#use-selectioncontext-consistently">4. Use SelectionContext Consistently</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#validate-geo-data-availability">5. Validate Geo Data Availability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#proxypoolemptyerror-no-proxies-with-ema-data">ProxyPoolEmptyError: No proxies with EMA data</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#sessionpersistencestrategy-requires-selectioncontext-with-session-id">SessionPersistenceStrategy requires SelectionContext with session_id</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#geo-targeting-returns-unexpected-proxies">Geo-targeting returns unexpected proxies</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#composite-strategy-too-slow">Composite strategy too slow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#testing-strategies">Testing Strategies</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#performance-benchmarks">Performance Benchmarks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#selection-time">Selection Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#memory-usage">Memory Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id17">Success Criteria</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="caching.html">Caching Subsystem Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="caching.html#architecture-overview">Architecture Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#tier-promotion-demotion">Tier Promotion &amp; Demotion</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#l2-vs-l3-sqlite-differences">L2 vs L3 SQLite Differences</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#core-components">Core Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#cachemanager">CacheManager</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#cacheentry">CacheEntry</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#cacheconfig">CacheConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#cachestatistics">CacheStatistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#credential-encryption">Credential Encryption</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#encryption-setup">Encryption Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#key-rotation">Key Rotation</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#encryption-behavior">Encryption Behavior</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#ttl-and-expiration">TTL and Expiration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#ttl-configuration">TTL Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#expiration-strategies">Expiration Strategies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#health-invalidation">Health Invalidation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#invalidation-workflow">Invalidation Workflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#migration-from-jsonl-l2-cache">Migration from JSONL L2 Cache</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#migrating-legacy-jsonl-caches">Migrating Legacy JSONL Caches</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#cache-warming">Cache Warming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#supported-formats">Supported Formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#warming-from-file">Warming from File</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#performance-tuning">Performance Tuning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#tier-sizing-recommendations">Tier Sizing Recommendations</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#eviction-policy-selection">Eviction Policy Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#performance-characteristics">Performance Characteristics</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#graceful-degradation">Graceful Degradation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#cli-integration">CLI Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#best-practices">Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#security">Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#performance">Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#reliability">Reliability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#example-complete-cache-setup">Example: Complete Cache Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#low-hit-rates">Low Hit Rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#high-memory-usage">High Memory Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#encryption-errors">Encryption Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#tier-degradation">Tier Degradation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="retry-failover.html">Retry &amp; Failover Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#when-to-use-retry-vs-failover">When to Use Retry vs Failover</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#retry-same-proxy">Retry (Same Proxy)</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#failover-different-proxy">Failover (Different Proxy)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#retrypolicy-configuration">RetryPolicy Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#basic-configuration">Basic Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#backoff-strategies">Backoff Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#jitter-explained">Jitter Explained</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#retryable-status-codes">Retryable Status Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#timeout-behavior">Timeout Behavior</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#non-idempotent-requests">Non-Idempotent Requests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#circuit-breaker-configuration">Circuit Breaker Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#sync-vs-async-circuit-breakers">Sync vs Async Circuit Breakers</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#state-machine">State Machine</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#thresholds-and-configuration">Thresholds and Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#circuit-breaker-persistence">Circuit Breaker Persistence</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#state-transitions">State Transitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#rolling-window-behavior">Rolling Window Behavior</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#manual-reset">Manual Reset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#intelligent-proxy-selection">Intelligent Proxy Selection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#selection-algorithm">Selection Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#example-performance-based-selection">Example: Performance-Based Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#example-geo-targeted-selection">Example: Geo-Targeted Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#exclusion-rules">Exclusion Rules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#retrymetrics-and-observability">RetryMetrics and Observability</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#collecting-metrics">Collecting Metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#summary-statistics">Summary Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#time-series-data">Time-Series Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#per-proxy-statistics">Per-Proxy Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#circuit-breaker-events">Circuit Breaker Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#hourly-aggregation">Hourly Aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#retention-configuration">Retention Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#retryexecutor-deep-dive">RetryExecutor Deep Dive</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#how-retries-work-internally">How Retries Work Internally</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#retryable-vs-non-retryable-errors">Retryable vs Non-Retryable Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#direct-retryexecutor-usage">Direct RetryExecutor Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#integration-with-proxyrotator">Integration with ProxyRotator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#custom-error-handling">Custom Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#monitoring-circuit-breakers">Monitoring Circuit Breakers</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#manual-circuit-reset">Manual Circuit Reset</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#integration-with-rotation-strategies">Integration with Rotation Strategies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#advanced-patterns">Advanced Patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#adaptive-retry-policy">Adaptive Retry Policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#circuit-breaker-alerts">Circuit Breaker Alerts</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#request-level-retry-override">Request-Level Retry Override</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#best-practices">Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#start-conservative-tune-later">1. Start Conservative, Tune Later</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#always-use-jitter-in-production">2. Always Use Jitter in Production</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#monitor-circuit-breaker-opens">3. Monitor Circuit Breaker Opens</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#set-timeouts-for-time-sensitive-requests">4. Set Timeouts for Time-Sensitive Requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#use-metrics-for-capacity-planning">5. Use Metrics for Capacity Planning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#all-retries-exhausted">All Retries Exhausted</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#high-latency">High Latency</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#non-retryable-errors">Non-Retryable Errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#performance-impact">Performance Impact</a></li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#related-documentation">Related Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Deployment Security &amp; Reverse Proxy Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#x-forwarded-for-security">X-Forwarded-For Security</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-attack">The Attack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-defense">The Defense</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reverse-proxy-configurations">Reverse Proxy Configurations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nginx">Nginx</a></li>
<li class="toctree-l4"><a class="reference internal" href="#caddy">Caddy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#haproxy">HAProxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#traefik">Traefik</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aws-application-load-balancer">AWS Application Load Balancer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#google-cloud-load-balancer">Google Cloud Load Balancer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#proxywhirl-configuration">ProxyWhirl Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#reading-client-ip-from-headers">Reading Client IP from Headers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#docker-compose-example">Docker Compose Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#security-checklist">Security Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rate-limiting-not-working">Rate Limiting Not Working</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metrics-showing-wrong-client-ips">Metrics Showing Wrong Client IPs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connection-refused-behind-reverse-proxy">Connection Refused Behind Reverse Proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-certificate-errors">SSL Certificate Errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#security-standards">Security Standards</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reverse-proxy-documentation">Reverse Proxy Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cloud-documentation">Cloud Documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="cli-reference.html">CLI Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#global-options">Global Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#config-auto-discovery">Config Auto-Discovery</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#commands">Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#request">request</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#pool">pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#config">config</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#health">health</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#fetch">fetch</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#export">export</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#setup-geoip">setup-geoip</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#sources">sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#stats">stats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#output-formats">Output Formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#text-default">Text (default)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#json">JSON</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#csv">CSV</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#configuration-file">Configuration File</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#advanced-usage">Advanced Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#scripting-with-json-output">Scripting with JSON Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#automated-proxy-refresh">Automated Proxy Refresh</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#ci-cd-integration">CI/CD Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#multi-environment-configuration">Multi-Environment Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#configuration-not-found">Configuration Not Found</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#lock-file-issues">Lock File Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#slow-validation">Slow Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#geoip-enrichment-not-working">GeoIP Enrichment Not Working</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#ssrf-protection-blocking-local-tests">SSRF Protection Blocking Local Tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html#exit-codes">Exit Codes</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="automation.html">Automation &amp; CI Runbook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="automation.html#pre-flight-checks">Pre-flight checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="automation.html#smoke-tests-for-docs-examples">Smoke tests for docs examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="automation.html#docsearch-credentials">DocSearch credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="automation.html#automating-releases">Automating releases</a></li>
<li class="toctree-l3"><a class="reference internal" href="automation.html#suggested-ci-stages">Suggested CI stages</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="mcp-server.html">MCP Server Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#quick-start">Quick Start</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#running-the-server">Running the Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#auto-loading-proxies">Auto-Loading Proxies</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#cli-options">CLI Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#the-proxywhirl-tool">The <code class="docutils literal notranslate"><span class="pre">proxywhirl</span></code> Tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#available-actions">Available Actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#action-examples">Action Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#resources">Resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#resource-proxywhirl-health">resource://proxywhirl/health</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#resource-proxywhirl-config">resource://proxywhirl/config</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#prompts">Prompts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#proxy-selection-workflow">proxy_selection_workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#troubleshooting-workflow">troubleshooting_workflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#authentication">Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#enabling-authentication">Enabling Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#authenticated-tool-calls">Authenticated Tool Calls</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#auth-middleware">Auth Middleware</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#disabling-authentication">Disabling Authentication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#progress-reporting">Progress Reporting</a></li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#transport-options">Transport Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#integration-with-claude-desktop">Integration with Claude Desktop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#macos">macOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#windows">Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#with-uvx-recommended">With uvx (Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#with-transport-options">With Transport Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#programmatic-usage">Programmatic Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#custom-rotator-configuration">Custom Rotator Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#lifecycle-management">Lifecycle Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#how-lifespan-works">How Lifespan Works</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#server-class-usage">Server Class Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#error-handling">Error Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#common-error-codes">Common Error Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#example-error-responses">Example Error Responses</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#best-practices">Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#always-check-pool-health-first">1. Always Check Pool Health First</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#use-recommendations-for-critical-requests">2. Use Recommendations for Critical Requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#monitor-circuit-breaker-states">3. Monitor Circuit Breaker States</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#handle-errors-gracefully">4. Handle Errors Gracefully</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#clean-up-resources">5. Clean Up Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#server-wont-start">Server Won&#8217;t Start</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#no-proxies-available">No Proxies Available</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#authentication-failures">Authentication Failures</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 _expand"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/rest-api.html">ProxyWhirl REST API Usage Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#getting-started">Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#starting-the-api-server">Starting the API Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#using-docker">Using Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#accessing-documentation">Accessing Documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#authentication">Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#no-authentication-default">No Authentication (Default)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#api-key-authentication">API Key Authentication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#endpoint-reference">Endpoint Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#rotation-strategy-configuration">Rotation Strategy Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#proxied-requests">Proxied Requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#pool-management">Pool Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#monitoring">Monitoring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#rate-limiting">Rate Limiting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#error-handling">Error Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#error-codes">Error Codes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#performance-tips">Performance Tips</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#use-connection-pooling">1. Use Connection Pooling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#enable-response-compression">2. Enable Response Compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#use-health-checks-efficiently">3. Use Health Checks Efficiently</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#monitor-metrics">4. Monitor Metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#configure-appropriate-timeouts">5. Configure Appropriate Timeouts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#use-persistent-storage">6. Use Persistent Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#optimize-retry-logic">7. Optimize Retry Logic</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#security-best-practices">Security Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#x-forwarded-for-security-warning">X-Forwarded-For Security Warning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#deployment-examples">Deployment Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#nginx-reverse-proxy-secure-configuration">Nginx Reverse Proxy (Secure Configuration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#kubernetes-deployment">Kubernetes Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#caddy-reverse-proxy-secure-configuration">Caddy Reverse Proxy (Secure Configuration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#haproxy-reverse-proxy-secure-configuration">HAProxy Reverse Proxy (Secure Configuration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#aws-application-load-balancer-alb-security">AWS Application Load Balancer (ALB) Security</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#x-forwarded-for-security-checklist">X-Forwarded-For Security Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#security-references">Security References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#api-wont-start">API Won&#8217;t Start</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#proxies-not-working">Proxies Not Working</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#rate-limiting-issues">Rate Limiting Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#high-latency">High Latency</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html#support">Support</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/python-api.html">Python API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#core-classes">Core Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxyrotator">ProxyRotator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#asyncproxyrotator">AsyncProxyRotator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxyfetcher">ProxyFetcher</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxyvalidator">ProxyValidator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#browserrenderer">BrowserRenderer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#rotation-strategies">Rotation Strategies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#roundrobinstrategy">RoundRobinStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#randomstrategy">RandomStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#weightedstrategy">WeightedStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#leastusedstrategy">LeastUsedStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#performancebasedstrategy">PerformanceBasedStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#sessionpersistencestrategy">SessionPersistenceStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#geotargetedstrategy">GeoTargetedStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#costawarestrategy">CostAwareStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#compositestrategy">CompositeStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#strategyregistry">StrategyRegistry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#data-models">Data Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxy">Proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxypool">ProxyPool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxychain">ProxyChain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxycredentials">ProxyCredentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxyconfiguration">ProxyConfiguration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#selectioncontext">SelectionContext</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#strategyconfig">StrategyConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#session">Session</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#cache-components">Cache Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#cachemanager">CacheManager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#cacheconfig">CacheConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#cacheentry">CacheEntry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#cachestatistics">CacheStatistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#retry-failover">Retry &amp; Failover</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#retrypolicy">RetryPolicy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#retryexecutor">RetryExecutor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#circuitbreaker">CircuitBreaker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#retrymetrics">RetryMetrics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#parsers">Parsers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#jsonparser">JSONParser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#csvparser">CSVParser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#plaintextparser">PlainTextParser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#htmltableparser">HTMLTableParser</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#configure-logging">configure_logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#is-valid-proxy-url">is_valid_proxy_url</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#parse-proxy-url">parse_proxy_url</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#validate-proxy-model">validate_proxy_model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#encrypt-credentials-decrypt-credentials">encrypt_credentials / decrypt_credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxy-to-dict">proxy_to_dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#create-proxy-from-url">create_proxy_from_url</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#deduplicate-proxies">deduplicate_proxies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#enumerations">Enumerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#healthstatus">HealthStatus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxysource">ProxySource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#proxyformat">ProxyFormat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#rendermode">RenderMode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#validationlevel">ValidationLevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#backoffstrategy">BackoffStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#circuitbreakerstate">CircuitBreakerState</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#built-in-proxy-sources">Built-in Proxy Sources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#individual-sources">Individual Sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#source-collections">Source Collections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#exceptions">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#type-annotations">Type Annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#version">Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/configuration.html">Configuration Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#configuration-discovery">Configuration Discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#toml-configuration-format">TOML Configuration Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#file-locations">File Locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#complete-configuration-example">Complete Configuration Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#environment-variables">Environment Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#security-encryption">Security &amp; Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#rest-api-configuration">REST API Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#configuration-classes">Configuration Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#cliconfig">CLIConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#datastorageconfig">DataStorageConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#proxyconfig">ProxyConfig</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#programmatic-configuration">Programmatic Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#loading-configuration">Loading Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#creating-configuration">Creating Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#saving-configuration">Saving Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#validation-rules">Validation Rules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#rotation-strategy">Rotation Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#output-format">Output Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#proxy-url-schemes">Proxy URL Schemes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#numeric-constraints">Numeric Constraints</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#security-best-practices">Security Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#credential-encryption">Credential Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#config-file-permissions">Config File Permissions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#api-key-security">API Key Security</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#configuration-examples">Configuration Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#minimal-configuration">Minimal Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#high-performance-configuration">High-Performance Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#privacy-focused-configuration">Privacy-Focused Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#analytics-enabled-configuration">Analytics-Enabled Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#migration-from-legacy-config">Migration from Legacy Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#config-file-not-found">Config File Not Found</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#invalid-toml-syntax">Invalid TOML Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#encryption-key-issues">Encryption Key Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html#related-documentation">Related Documentation</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/exceptions.html">Exceptions Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#exception-hierarchy">Exception Hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#proxyerrorcode-enum">ProxyErrorCode Enum</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#redact-url">redact_url()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#error-codes">Error Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#exception-reference">Exception Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxywhirlerror">ProxyWhirlError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxyvalidationerror">ProxyValidationError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxypoolemptyerror">ProxyPoolEmptyError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxyconnectionerror">ProxyConnectionError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxyauthenticationerror">ProxyAuthenticationError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxyfetcherror">ProxyFetchError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxystorageerror">ProxyStorageError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#cachecorruptionerror">CacheCorruptionError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#cachestorageerror">CacheStorageError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#cachevalidationerror">CacheValidationError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#requestqueuefullerror">RequestQueueFullError</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#error-handling-patterns">Error Handling Patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#basic-error-handling">Basic Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#catch-all-error-handling">Catch-All Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#retry-logic-based-on-error-type">Retry Logic Based on Error Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#async-error-handling">Async Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#rest-api-error-handling">REST API Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#context-manager-pattern">Context Manager Pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#error-aggregation">Error Aggregation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#best-practices">Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#use-specific-exceptions">1. Use Specific Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#check-retry-recommended-flag">2. Check retry_recommended Flag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#use-error-codes-for-programmatic-handling">3. Use Error Codes for Programmatic Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#log-structured-error-data">4. Log Structured Error Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#implement-circuit-breaker-pattern">5. Implement Circuit Breaker Pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#provide-user-friendly-error-messages">6. Provide User-Friendly Error Messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#test-error-handling">7. Test Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#monitor-error-rates">8. Monitor Error Rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#handle-async-errors-properly">9. Handle Async Errors Properly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#document-error-handling">10. Document Error Handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/cache-api.html">Cache API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#data-models">Data Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#cacheentry">CacheEntry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#cacheconfig">CacheConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#cachetierconfig">CacheTierConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#cachestatistics">CacheStatistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#tierstatistics">TierStatistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#healthstatus-enum">HealthStatus (Enum)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#cachetiertype-enum">CacheTierType (Enum)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#l2backendtype-enum">L2BackendType (Enum)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#tier-implementations">Tier Implementations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#cachetier-abstract-base-class">CacheTier (Abstract Base Class)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#memorycachetier">MemoryCacheTier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#jsonlcachetier">JsonlCacheTier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#diskcachetier">DiskCacheTier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#sqlitecachetier">SQLiteCacheTier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#utilities">Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#credentialencryptor">CredentialEncryptor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#cachemanager">CacheManager</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#usage-examples">Usage Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#working-with-cache-tiers-directly">Working with Cache Tiers Directly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#encryption-and-security">Encryption and Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#migration-from-jsonl-to-sqlite-l2">Migration from JSONL to SQLite L2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#tier-selection">Tier Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#optimization-tips">Optimization Tips</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/rate-limiting-api.html">Rate Limiting API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#core-classes">Core Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#ratelimiter">RateLimiter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#data-models">Data Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#ratelimit">RateLimit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#ratelimitevent">RateLimitEvent</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#usage-examples">Usage Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#basic-rate-limiting">Basic Rate Limiting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#global-per-proxy-limits">Global + Per-Proxy Limits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#burst-handling">Burst Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#dynamic-limit-adjustment">Dynamic Limit Adjustment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#integration-with-proxyrotator">Integration with ProxyRotator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#monitoring-and-logging">Monitoring and Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#retry-with-backoff">Retry with Backoff</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#token-bucket-algorithm">Token Bucket Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#memory-usage">Memory Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#concurrency">Concurrency</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#integration-with-monitoring">Integration with Monitoring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#prometheus-metrics">Prometheus Metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#datadog-integration">DataDog Integration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#sphinx-integration">Sphinx Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#common-patterns">Common Patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#fallback-to-different-proxy">Fallback to Different Proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#batch-requests-with-rate-limiting">Batch Requests with Rate Limiting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#circuit-breaker-integration">Circuit Breaker Integration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html#faq">FAQ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 _expand"><a class="reference internal" href="../project/index.html">Project Status &amp; Roadmap</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#current-health">Current health</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#collaboration-checklists">Collaboration checklists</a></li>
</ul>
</li>
</ul>
        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#x-forwarded-for-security">X-Forwarded-For Security</a><ul>
<li><a class="reference internal" href="#the-attack">The Attack</a></li>
<li><a class="reference internal" href="#the-defense">The Defense</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reverse-proxy-configurations">Reverse Proxy Configurations</a><ul>
<li><a class="reference internal" href="#nginx">Nginx</a></li>
<li><a class="reference internal" href="#caddy">Caddy</a></li>
<li><a class="reference internal" href="#haproxy">HAProxy</a></li>
<li><a class="reference internal" href="#traefik">Traefik</a></li>
<li><a class="reference internal" href="#aws-application-load-balancer">AWS Application Load Balancer</a></li>
<li><a class="reference internal" href="#google-cloud-load-balancer">Google Cloud Load Balancer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#proxywhirl-configuration">ProxyWhirl Configuration</a><ul>
<li><a class="reference internal" href="#reading-client-ip-from-headers">Reading Client IP from Headers</a></li>
<li><a class="reference internal" href="#docker-compose-example">Docker Compose Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-checklist">Security Checklist</a></li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#rate-limiting-not-working">Rate Limiting Not Working</a></li>
<li><a class="reference internal" href="#metrics-showing-wrong-client-ips">Metrics Showing Wrong Client IPs</a></li>
<li><a class="reference internal" href="#connection-refused-behind-reverse-proxy">Connection Refused Behind Reverse Proxy</a></li>
<li><a class="reference internal" href="#ssl-certificate-errors">SSL Certificate Errors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a><ul>
<li><a class="reference internal" href="#security-standards">Security Standards</a></li>
<li><a class="reference internal" href="#reverse-proxy-documentation">Reverse Proxy Documentation</a></li>
<li><a class="reference internal" href="#cloud-documentation">Cloud Documentation</a></li>
</ul>
</li>
</ul>
</div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">ProxyWhirl</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="index.html"><span itemprop="name">Guides</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">Deployment Security &amp; Reverse Proxy Configuration</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="relative min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
  <div class="copy-page-wrapper relative pb-4 lg:absolute lg:top-8 lg:right-6 xl:right-12">
  <div id="copy-page-trigger">
    <button
      type="button"
      class="js-copy px-3 py-1 inline-flex items-center gap-1"
      data-url="https://proxywhirl.readthedocs.io/_sources/guides/deployment-security.md.txt"
    >
      <i class="i-lucide" data-icon="copy"></i>
      <span>Copy page</span>
    </button>
    <button class="js-menu px-2 py-1" type="button" aria-label="More actions"
      aria-haspopup="menu" aria-expanded="false" aria-controls="copy-page-content">
      <i class="i-lucide chevron-down"></i>
    </button>
  </div>
  <div id="copy-page-content" role="menu" aria-orientation="vertical" aria-hidden="true">
    <div role="presentation">
      <div class="flex flex-col" role="group">
        <button class="js-copy" type="button" role="menuitem"
          data-url="https://proxywhirl.readthedocs.io/_sources/guides/deployment-security.md.txt">
          <span class="iconify-icon">
            <i class="i-lucide" data-icon="copy"></i>
          </span>
          <span>Copy page</span>
        </button>
        <a role="menuitem" href="https://proxywhirl.readthedocs.io/_sources/guides/deployment-security.md.txt" target="_blank" rel="nofollow"><iconify-icon icon="bi:markdown"></iconify-icon>
            <span>View as Markdown</span></a><a role="menuitem" href="https://chatgpt.com/?hints=search&q=Read%20https%3A//proxywhirl.readthedocs.io/_sources/guides/deployment-security.md.txt%20so%20I%20can%20ask%20questions%20about%20it." target="_blank" rel="nofollow">
          <iconify-icon icon="bi:openai"></iconify-icon>
          <span>Open in ChatGPT</span>
        </a><a role="menuitem" href="https://claude.ai/new?q=Read%20https%3A//proxywhirl.readthedocs.io/_sources/guides/deployment-security.md.txt%20so%20I%20can%20ask%20questions%20about%20it." target="_blank" rel="nofollow">
          <iconify-icon icon="bi:claude"></iconify-icon>
          <span>Open in Claude</span>
        </a></div>
    </div>
  </div>
</div><article class="yue" role="main">
          <section id="deployment-security-reverse-proxy-configuration">
<h1>Deployment Security &amp; Reverse Proxy Configuration<a class="headerlink" href="#deployment-security-reverse-proxy-configuration" title="Link to this heading"></a></h1>
<p>Complete guide for securely deploying ProxyWhirl in production with trusted reverse proxy configurations.</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#overview">Overview</a></p></li>
<li><p><a class="reference internal" href="#x-forwarded-for-security">X-Forwarded-For Security</a></p>
<ul>
<li><p><a class="reference internal" href="#the-attack">The Attack</a></p></li>
<li><p><a class="reference internal" href="#the-defense">The Defense</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#reverse-proxy-configurations">Reverse Proxy Configurations</a></p>
<ul>
<li><p><a class="reference internal" href="#nginx">Nginx</a></p></li>
<li><p><a class="reference internal" href="#caddy">Caddy</a></p></li>
<li><p><a class="reference internal" href="#haproxy">HAProxy</a></p></li>
<li><p><a class="reference internal" href="#traefik">Traefik</a></p></li>
<li><p><a class="reference internal" href="#aws-application-load-balancer">AWS Application Load Balancer</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#proxywhirl-configuration">ProxyWhirl Configuration</a></p></li>
<li><p><a class="reference internal" href="#security-checklist">Security Checklist</a></p></li>
<li><p><a class="reference internal" href="#troubleshooting">Troubleshooting</a></p></li>
<li><p><a class="reference internal" href="#references">References</a></p></li>
</ul>
</section>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>When deploying ProxyWhirl behind a reverse proxy in production, the rate limiting and client identification features depend on accurately determining the real client IP address. This is the critical security boundary that prevents attackers from spoofing their IP to bypass rate limits.</p>
<p><strong>Recommended Architecture:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1">Internet
</span><span data-line="2">    
</span><span data-line="3">[Reverse Proxy: Nginx/Caddy/HAProxy/Cloud LB]   Clears untrusted headers
</span><span data-line="4">     (X-Real-IP or X-Forwarded-For set here)
</span><span data-line="5">[ProxyWhirl API Server]   Reads trusted headers
</span><span data-line="6">    
</span><span data-line="7">[Proxy Pool Management]
</span></pre></div>
</div>
</section>
<section id="x-forwarded-for-security">
<h2>X-Forwarded-For Security<a class="headerlink" href="#x-forwarded-for-security" title="Link to this heading"></a></h2>
<section id="the-attack">
<h3>The Attack<a class="headerlink" href="#the-attack" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> HTTP header is designed to pass the real client IP through proxy chains. However, since HTTP headers can be set by any client, an attacker can forge this header to bypass security controls:</p>
<p><strong>Attack Scenario:</strong></p>
<ol class="arabic">
<li><p><strong>Attacker sends request with forged header:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">GET</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">request</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</span><span data-line="2"><span class="n">Host</span><span class="p">:</span> <span class="n">api</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</span><span data-line="3"><span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">For</span><span class="p">:</span> <span class="mf">192.0.2.1</span><span class="p">,</span> <span class="mf">198.51.100.2</span>
</span></pre></div>
</div>
</li>
<li><p><strong>Untrusted reverse proxy appends attackers IP:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">For</span><span class="p">:</span> <span class="mf">192.0.2.1</span><span class="p">,</span> <span class="mf">198.51.100.2</span><span class="p">,</span> <span class="mf">203.0.113.50</span>
</span></pre></div>
</div>
</li>
<li><p><strong>If ProxyWhirl reads leftmost IP (192.0.2.1), rate limiting is bypassed:</strong></p>
<ul class="simple">
<li><p>Attacker can exhaust rate limits under spoofed IPs</p></li>
<li><p>1000 requests/min limit becomes 1000 per unique forged IP</p></li>
<li><p>Legitimate rate limiting is rendered ineffective</p></li>
</ul>
</li>
</ol>
</section>
<section id="the-defense">
<h3>The Defense<a class="headerlink" href="#the-defense" title="Link to this heading"></a></h3>
<p><strong>Key Principle:</strong> Your reverse proxy must be configured to <strong>clear or overwrite</strong> any client-provided <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> header and set it to the real connecting IP address.</p>
<p><strong>Three Critical Requirements:</strong></p>
<ol class="arabic simple">
<li><p><strong>Clear untrusted headers</strong> from incoming requests</p></li>
<li><p><strong>Set correct forwarding headers</strong> with the real client IP</p></li>
<li><p><strong>ProxyWhirl trusts only the configured header</strong> (e.g., <code class="docutils literal notranslate"><span class="pre">X-Real-IP</span></code> or the rightmost IP in <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code>)</p></li>
</ol>
</section>
</section>
<section id="reverse-proxy-configurations">
<h2>Reverse Proxy Configurations<a class="headerlink" href="#reverse-proxy-configurations" title="Link to this heading"></a></h2>
<section id="nginx">
<h3>Nginx<a class="headerlink" href="#nginx" title="Link to this heading"></a></h3>
<p><strong>Secure Configuration (Single Proxy):</strong></p>
<div class="highlight-nginx notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">server</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="2"><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
</span><span data-line="3"><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">api.example.com</span><span class="p">;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="6"><span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://proxywhirl:8000</span><span class="p">;</span>
</span><span data-line="7"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span data-line="8">
</span><span data-line="9"><span class="w">        </span><span class="c1"># Critical: Use $remote_addr (cannot be spoofed by clients)</span>
</span><span data-line="10"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span data-line="11">
</span><span data-line="12"><span class="w">        </span><span class="c1"># Set clean X-Forwarded-For from real client IP only</span>
</span><span data-line="13"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span data-line="14">
</span><span data-line="15"><span class="w">        </span><span class="c1"># Preserve other forwarding context</span>
</span><span data-line="16"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
</span><span data-line="17"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span data-line="18"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Port</span><span class="w"> </span><span class="nv">$server_port</span><span class="p">;</span>
</span><span data-line="19">
</span><span data-line="20"><span class="w">        </span><span class="c1"># Connection handling</span>
</span><span data-line="21"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</span><span data-line="22"><span class="w">        </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span><span data-line="23"><span class="w">    </span><span class="p">}</span>
</span><span data-line="24"><span class="p">}</span>
</span></pre></div>
</div>
<p><strong>Secure Configuration (Multi-Proxy Chain with ngx_realip Module):</strong></p>
<p>When ProxyWhirl sits behind multiple proxies (e.g., CDN  nginx  app), use the <code class="docutils literal notranslate"><span class="pre">ngx_realip</span></code> module:</p>
<div class="highlight-nginx notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Load the realip module (may be compiled in or as a dynamic module)</span>
</span><span data-line="2"><span class="c1"># If dynamic: load_module modules/ngx_http_realip_module.so;</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">server</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="5"><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
</span><span data-line="6"><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">api.example.com</span><span class="p">;</span>
</span><span data-line="7">
</span><span data-line="8"><span class="w">    </span><span class="c1"># Configure which upstream proxies are trusted</span>
</span><span data-line="9"><span class="w">    </span><span class="kn">set_real_ip_from</span><span class="w"> </span><span class="mi">10</span><span class="s">.0.0.0/8</span><span class="p">;</span><span class="w">      </span><span class="c1"># Trust internal network</span>
</span><span data-line="10"><span class="w">    </span><span class="kn">set_real_ip_from</span><span class="w"> </span><span class="mi">172</span><span class="s">.16.0.0/12</span><span class="p">;</span><span class="w">   </span><span class="c1"># Docker subnet</span>
</span><span data-line="11"><span class="w">    </span><span class="kn">set_real_ip_from</span><span class="w"> </span><span class="mi">203</span><span class="s">.0.113.0/24</span><span class="p">;</span><span class="w">  </span><span class="c1"># Your CDN IP range</span>
</span><span data-line="12">
</span><span data-line="13"><span class="w">    </span><span class="kn">real_ip_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="p">;</span>
</span><span data-line="14"><span class="w">    </span><span class="kn">real_ip_recursive</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
</span><span data-line="15">
</span><span data-line="16"><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="17"><span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://proxywhirl:8000</span><span class="p">;</span>
</span><span data-line="18"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span data-line="19">
</span><span data-line="20"><span class="w">        </span><span class="c1"># After real_ip processing, $remote_addr is the true client IP</span>
</span><span data-line="21"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span data-line="22"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span data-line="23"><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
</span><span data-line="24"><span class="w">    </span><span class="p">}</span>
</span><span data-line="25"><span class="p">}</span>
</span></pre></div>
</div>
<p><strong>Key Points:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$remote_addr</span></code> is the connecting clients IP (cannot be spoofed)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_real_ip_from</span></code> whitelists trusted upstream proxies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">real_ip_recursive</span> <span class="pre">on</span></code> processes the entire X-Forwarded-For chain</p></li>
<li><p>Only trust proxies <strong>within your control</strong></p></li>
</ul>
</section>
<section id="caddy">
<h3>Caddy<a class="headerlink" href="#caddy" title="Link to this heading"></a></h3>
<p><strong>Secure Configuration:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span data-line="1">api.example.com {
</span><span data-line="2">    reverse_proxy localhost:8000 {
</span><span data-line="3">        # Replace X-Forwarded-For with real client IP
</span><span data-line="4">        # (Caddy removes untrusted headers by default)
</span><span data-line="5">        header_up -X-Forwarded-For
</span><span data-line="6">        header_up X-Forwarded-For {http.request.remote.host}
</span><span data-line="7">
</span><span data-line="8">        # Set X-Real-IP to the actual client IP
</span><span data-line="9">        header_up X-Real-IP {http.request.remote.host}
</span><span data-line="10">
</span><span data-line="11">        # Preserve protocol and host information
</span><span data-line="12">        header_up X-Forwarded-Proto {http.request.proto}
</span><span data-line="13">        header_up X-Forwarded-Host {http.request.host}
</span><span data-line="14">        header_up X-Forwarded-Port {http.request.port}
</span><span data-line="15">    }
</span><span data-line="16">}
</span></pre></div>
</div>
<p><strong>Advantages:</strong></p>
<ul class="simple">
<li><p>Caddy automatically removes untrusted X-Forwarded-For headers from clients</p></li>
<li><p>Simple, secure-by-default configuration</p></li>
<li><p>Excellent choice for production without extensive tuning</p></li>
</ul>
</section>
<section id="haproxy">
<h3>HAProxy<a class="headerlink" href="#haproxy" title="Link to this heading"></a></h3>
<p><strong>Secure Configuration:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span data-line="1">global
</span><span data-line="2">    log stdout local0
</span><span data-line="3">    maxconn 4096
</span><span data-line="4">
</span><span data-line="5">defaults
</span><span data-line="6">    log global
</span><span data-line="7">    mode http
</span><span data-line="8">    timeout connect 5s
</span><span data-line="9">    timeout client 50s
</span><span data-line="10">    timeout server 50s
</span><span data-line="11">
</span><span data-line="12">frontend api_frontend
</span><span data-line="13">    bind 0.0.0.0:80
</span><span data-line="14">    default_backend api_backend
</span><span data-line="15">
</span><span data-line="16">    # Security: Normalize headers to prevent spoofing
</span><span data-line="17">    # Extract real client IP from connection
</span><span data-line="18">    http-request set-header X-Real-IP %[src]
</span><span data-line="19">
</span><span data-line="20">    # For X-Forwarded-For chains, only keep the real client IP
</span><span data-line="21">    http-request set-header X-Forwarded-For %[src]
</span><span data-line="22">    http-request set-header X-Forwarded-Proto %[req.hdr(X-Forwarded-Proto)]
</span><span data-line="23">
</span><span data-line="24">    # Additional security headers
</span><span data-line="25">    http-request set-header X-Forwarded-Host %[req.hdr(Host)]
</span><span data-line="26">
</span><span data-line="27">backend api_backend
</span><span data-line="28">    balance roundrobin
</span><span data-line="29">
</span><span data-line="30">    # Configure ProxyWhirl server
</span><span data-line="31">    server api1 localhost:8000 check
</span><span data-line="32">
</span><span data-line="33">    # Preserve client IP in backend communication
</span><span data-line="34">    option forwardfor
</span><span data-line="35">
</span><span data-line="36">    # Additional security response headers
</span><span data-line="37">    http-response set-header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains&quot;
</span><span data-line="38">    http-response set-header X-Content-Type-Options &quot;nosniff&quot;
</span></pre></div>
</div>
<p><strong>Key Points:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%[src]</span></code> is HAProxys source IP (cannot be spoofed)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">http-request</span> <span class="pre">set-header</span></code> is evaluated per request (before any client manipulation)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">option</span> <span class="pre">forwardfor</span></code> adds/updates X-Forwarded-For with the real client IP</p></li>
</ul>
</section>
<section id="traefik">
<h3>Traefik<a class="headerlink" href="#traefik" title="Link to this heading"></a></h3>
<p><strong>Secure Configuration (docker-compose):</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>
</span><span data-line="2">
</span><span data-line="3"><span class="nt">services</span><span class="p">:</span>
</span><span data-line="4"><span class="w">  </span><span class="nt">traefik</span><span class="p">:</span>
</span><span data-line="5"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">traefik:latest</span>
</span><span data-line="6"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
</span><span data-line="7"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>
</span><span data-line="8"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8080:8080&quot;</span>
</span><span data-line="9"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
</span><span data-line="10"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock</span>
</span><span data-line="11"><span class="w">    </span><span class="nt">command</span><span class="p">:</span>
</span><span data-line="12"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;--api.insecure=true&quot;</span>
</span><span data-line="13"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;--providers.docker=true&quot;</span>
</span><span data-line="14"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;--providers.docker.exposedbydefault=false&quot;</span>
</span><span data-line="15"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;--entrypoints.web.address=:80&quot;</span>
</span><span data-line="16"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
</span><span data-line="17"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxywhirl-net</span>
</span><span data-line="18">
</span><span data-line="19"><span class="w">  </span><span class="nt">proxywhirl</span><span class="p">:</span>
</span><span data-line="20"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxywhirl-api:latest</span>
</span><span data-line="21"><span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
</span><span data-line="22"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.enable=true&quot;</span>
</span><span data-line="23"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.proxywhirl.rule=Host(`api.example.com`)&quot;</span>
</span><span data-line="24"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.proxywhirl.entrypoints=web&quot;</span>
</span><span data-line="25"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.services.proxywhirl.loadbalancer.server.port=8000&quot;</span>
</span><span data-line="26">
</span><span data-line="27"><span class="w">      </span><span class="c1"># Security: Forward real client IP</span>
</span><span data-line="28"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.middlewares.client-ip.headers.customrequestheaders.X-Real-IP={{</span><span class="nv"> </span><span class="s">.ClientIP</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span data-line="29"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.middlewares.client-ip.headers.customrequestheaders.X-Forwarded-For={{</span><span class="nv"> </span><span class="s">.ClientIP</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span data-line="30"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.proxywhirl.middlewares=client-ip&quot;</span>
</span><span data-line="31">
</span><span data-line="32"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
</span><span data-line="33"><span class="w">      </span><span class="nt">PROXYWHIRL_STORAGE_PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/proxies.db</span>
</span><span data-line="34"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
</span><span data-line="35"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxywhirl-data:/data</span>
</span><span data-line="36"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
</span><span data-line="37"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxywhirl-net</span>
</span><span data-line="38">
</span><span data-line="39"><span class="nt">networks</span><span class="p">:</span>
</span><span data-line="40"><span class="w">  </span><span class="nt">proxywhirl-net</span><span class="p">:</span>
</span><span data-line="41"><span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge</span>
</span><span data-line="42">
</span><span data-line="43"><span class="nt">volumes</span><span class="p">:</span>
</span><span data-line="44"><span class="w">  </span><span class="nt">proxywhirl-data</span><span class="p">:</span>
</span></pre></div>
</div>
<p><strong>Alternative (File-based Configuration):</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># traefik-config.yml</span>
</span><span data-line="2"><span class="nt">http</span><span class="p">:</span>
</span><span data-line="3"><span class="w">  </span><span class="nt">middlewares</span><span class="p">:</span>
</span><span data-line="4"><span class="w">    </span><span class="nt">client-ip</span><span class="p">:</span>
</span><span data-line="5"><span class="w">      </span><span class="nt">headers</span><span class="p">:</span>
</span><span data-line="6"><span class="w">        </span><span class="nt">customRequestHeaders</span><span class="p">:</span>
</span><span data-line="7"><span class="w">          </span><span class="nt">X-Real-IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">.ClientIP</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span data-line="8"><span class="w">          </span><span class="nt">X-Forwarded-For</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">.ClientIP</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span data-line="9">
</span><span data-line="10"><span class="w">  </span><span class="nt">routers</span><span class="p">:</span>
</span><span data-line="11"><span class="w">    </span><span class="nt">proxywhirl</span><span class="p">:</span>
</span><span data-line="12"><span class="w">      </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Host(`api.example.com`)&quot;</span>
</span><span data-line="13"><span class="w">      </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxywhirl-api</span>
</span><span data-line="14"><span class="w">      </span><span class="nt">middlewares</span><span class="p">:</span>
</span><span data-line="15"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">client-ip</span>
</span><span data-line="16">
</span><span data-line="17"><span class="w">  </span><span class="nt">services</span><span class="p">:</span>
</span><span data-line="18"><span class="w">    </span><span class="nt">proxywhirl-api</span><span class="p">:</span>
</span><span data-line="19"><span class="w">      </span><span class="nt">loadBalancer</span><span class="p">:</span>
</span><span data-line="20"><span class="w">        </span><span class="nt">servers</span><span class="p">:</span>
</span><span data-line="21"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://localhost:8000&quot;</span>
</span></pre></div>
</div>
</section>
<section id="aws-application-load-balancer">
<h3>AWS Application Load Balancer<a class="headerlink" href="#aws-application-load-balancer" title="Link to this heading"></a></h3>
<p><strong>Secure Configuration (Terraform):</strong></p>
<div class="highlight-hcl notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_lb_target_group&quot;</span><span class="w"> </span><span class="nv">&quot;proxywhirl&quot;</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="2"><span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;proxywhirl-api&quot;</span>
</span><span data-line="3"><span class="w">  </span><span class="na">port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="m">8000</span>
</span><span data-line="4"><span class="w">  </span><span class="na">protocol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;HTTP&quot;</span>
</span><span data-line="5"><span class="w">  </span><span class="na">vpc_id</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.main.id</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1">  # Essential: Preserve client IP in ALB</span>
</span><span data-line="8"><span class="w">  </span><span class="nb">stickiness</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="9"><span class="w">    </span><span class="na">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span>
</span><span data-line="10"><span class="w">  </span><span class="p">}</span>
</span><span data-line="11">
</span><span data-line="12"><span class="c1">  # Health check configuration</span>
</span><span data-line="13"><span class="w">  </span><span class="nb">health_check</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="14"><span class="w">    </span><span class="na">path</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/api/v1/health&quot;</span>
</span><span data-line="15"><span class="w">    </span><span class="na">port</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;8000&quot;</span>
</span><span data-line="16"><span class="w">    </span><span class="na">protocol</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;HTTP&quot;</span>
</span><span data-line="17"><span class="w">    </span><span class="na">healthy_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
</span><span data-line="18"><span class="w">    </span><span class="na">unhealthy_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
</span><span data-line="19"><span class="w">    </span><span class="na">timeout</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
</span><span data-line="20"><span class="w">    </span><span class="na">interval</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="m">30</span>
</span><span data-line="21"><span class="w">    </span><span class="na">matcher</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;200&quot;</span>
</span><span data-line="22"><span class="w">  </span><span class="p">}</span>
</span><span data-line="23">
</span><span data-line="24"><span class="w">  </span><span class="nb">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="25"><span class="w">    </span><span class="na">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;proxywhirl-api&quot;</span>
</span><span data-line="26"><span class="w">  </span><span class="p">}</span>
</span><span data-line="27"><span class="p">}</span>
</span><span data-line="28">
</span><span data-line="29"><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_lb_listener&quot;</span><span class="w"> </span><span class="nv">&quot;http&quot;</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="30"><span class="w">  </span><span class="na">load_balancer_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_lb.main.arn</span>
</span><span data-line="31"><span class="w">  </span><span class="na">port</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="m">80</span>
</span><span data-line="32"><span class="w">  </span><span class="na">protocol</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;HTTP&quot;</span>
</span><span data-line="33">
</span><span data-line="34"><span class="w">  </span><span class="nb">default_action</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="35"><span class="w">    </span><span class="na">type</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;forward&quot;</span>
</span><span data-line="36"><span class="w">    </span><span class="na">target_group_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_lb_target_group.proxywhirl.arn</span>
</span><span data-line="37"><span class="w">  </span><span class="p">}</span>
</span><span data-line="38"><span class="p">}</span>
</span><span data-line="39">
</span><span data-line="40"><span class="c1"># Security Group: Restrict to ALB traffic</span>
</span><span data-line="41"><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_security_group&quot;</span><span class="w"> </span><span class="nv">&quot;proxywhirl&quot;</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="42"><span class="w">  </span><span class="na">name_prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;proxywhirl-&quot;</span>
</span><span data-line="43"><span class="w">  </span><span class="na">vpc_id</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.main.id</span>
</span><span data-line="44">
</span><span data-line="45"><span class="w">  </span><span class="nb">ingress</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="46"><span class="w">    </span><span class="na">from_port</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="m">8000</span>
</span><span data-line="47"><span class="w">    </span><span class="na">to_port</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="m">8000</span>
</span><span data-line="48"><span class="w">    </span><span class="na">protocol</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tcp&quot;</span>
</span><span data-line="49"><span class="w">    </span><span class="na">security_groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nv">aws_security_group.alb.id</span><span class="p">]</span>
</span><span data-line="50"><span class="w">    </span><span class="na">description</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;From ALB only&quot;</span>
</span><span data-line="51"><span class="w">  </span><span class="p">}</span>
</span><span data-line="52">
</span><span data-line="53"><span class="w">  </span><span class="nb">egress</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="54"><span class="w">    </span><span class="na">from_port</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span><span data-line="55"><span class="w">    </span><span class="na">to_port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span><span data-line="56"><span class="w">    </span><span class="na">protocol</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-1&quot;</span>
</span><span data-line="57"><span class="w">    </span><span class="na">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;0.0.0.0/0&quot;</span><span class="p">]</span>
</span><span data-line="58"><span class="w">  </span><span class="p">}</span>
</span><span data-line="59">
</span><span data-line="60"><span class="w">  </span><span class="nb">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span data-line="61"><span class="w">    </span><span class="na">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;proxywhirl-sg&quot;</span>
</span><span data-line="62"><span class="w">  </span><span class="p">}</span>
</span><span data-line="63"><span class="p">}</span>
</span></pre></div>
</div>
<p><strong>ALB Sets These Headers:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">For</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">client</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span>
</span><span data-line="2"><span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">Proto</span><span class="p">:</span> <span class="n">https</span>
</span><span data-line="3"><span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">Port</span><span class="p">:</span> <span class="mi">443</span>
</span><span data-line="4"><span class="n">X</span><span class="o">-</span><span class="n">Amzn</span><span class="o">-</span><span class="n">Trace</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">aws</span><span class="o">-</span><span class="n">trace</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
</span></pre></div>
</div>
<p><strong>Security Notes:</strong></p>
<ul class="simple">
<li><p>ALB is managed by AWS and automatically clears untrusted headers</p></li>
<li><p>Enable Preserve client IP in target group attributes</p></li>
<li><p>Trust ALBs IP range (use security groups)</p></li>
<li><p>ProxyWhirl should read <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> (rightmost IP is client)</p></li>
</ul>
</section>
<section id="google-cloud-load-balancer">
<h3>Google Cloud Load Balancer<a class="headerlink" href="#google-cloud-load-balancer" title="Link to this heading"></a></h3>
<p><strong>Secure Configuration (gcloud):</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Create backend service</span>
</span><span data-line="2">gcloud<span class="w"> </span>compute<span class="w"> </span>backend-services<span class="w"> </span>create<span class="w"> </span>proxywhirl-backend<span class="w"> </span><span class="se">\</span>
</span><span data-line="3"><span class="w">  </span>--protocol<span class="o">=</span>HTTP<span class="w"> </span><span class="se">\</span>
</span><span data-line="4"><span class="w">  </span>--health-checks<span class="o">=</span>proxywhirl-health-check<span class="w"> </span><span class="se">\</span>
</span><span data-line="5"><span class="w">  </span>--global<span class="w"> </span><span class="se">\</span>
</span><span data-line="6"><span class="w">  </span>--session-affinity<span class="o">=</span>NONE
</span><span data-line="7">
</span><span data-line="8"><span class="c1"># Add instance group to backend</span>
</span><span data-line="9">gcloud<span class="w"> </span>compute<span class="w"> </span>backend-services<span class="w"> </span>add-backend<span class="w"> </span>proxywhirl-backend<span class="w"> </span><span class="se">\</span>
</span><span data-line="10"><span class="w">  </span>--instance-group<span class="o">=</span>proxywhirl-ig<span class="w"> </span><span class="se">\</span>
</span><span data-line="11"><span class="w">  </span>--instance-group-zone<span class="o">=</span>us-central1-a<span class="w"> </span><span class="se">\</span>
</span><span data-line="12"><span class="w">  </span>--global
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Create URL map</span>
</span><span data-line="15">gcloud<span class="w"> </span>compute<span class="w"> </span>url-maps<span class="w"> </span>create<span class="w"> </span>proxywhirl-lb<span class="w"> </span><span class="se">\</span>
</span><span data-line="16"><span class="w">  </span>--default-service<span class="o">=</span>proxywhirl-backend
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Create HTTP proxy</span>
</span><span data-line="19">gcloud<span class="w"> </span>compute<span class="w"> </span>target-http-proxies<span class="w"> </span>create<span class="w"> </span>proxywhirl-proxy<span class="w"> </span><span class="se">\</span>
</span><span data-line="20"><span class="w">  </span>--url-map<span class="o">=</span>proxywhirl-lb
</span><span data-line="21">
</span><span data-line="22"><span class="c1"># Create forwarding rule</span>
</span><span data-line="23">gcloud<span class="w"> </span>compute<span class="w"> </span>forwarding-rules<span class="w"> </span>create<span class="w"> </span>proxywhirl-forwarding<span class="w"> </span><span class="se">\</span>
</span><span data-line="24"><span class="w">  </span>--global<span class="w"> </span><span class="se">\</span>
</span><span data-line="25"><span class="w">  </span>--target-http-proxy<span class="o">=</span>proxywhirl-proxy<span class="w"> </span><span class="se">\</span>
</span><span data-line="26"><span class="w">  </span>--address<span class="o">=</span>proxywhirl-ip<span class="w"> </span><span class="se">\</span>
</span><span data-line="27"><span class="w">  </span>--port-range<span class="o">=</span><span class="m">80</span>
</span></pre></div>
</div>
<p><strong>GCP Load Balancer Sets:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">For</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">client</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span>
</span><span data-line="2"><span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">Proto</span><span class="p">:</span> <span class="n">https</span>
</span></pre></div>
</div>
<p><strong>Security Notes:</strong></p>
<ul class="simple">
<li><p>GCP Load Balancer automatically manages header security</p></li>
<li><p>Use Cloud Armor to enforce additional IP restrictions</p></li>
<li><p>Restrict backend access to LB IP range only</p></li>
</ul>
</section>
</section>
<section id="proxywhirl-configuration">
<h2>ProxyWhirl Configuration<a class="headerlink" href="#proxywhirl-configuration" title="Link to this heading"></a></h2>
<section id="reading-client-ip-from-headers">
<h3>Reading Client IP from Headers<a class="headerlink" href="#reading-client-ip-from-headers" title="Link to this heading"></a></h3>
<p>ProxyWhirl automatically reads the client IP from trusted headers for rate limiting:</p>
<p><strong>Priority Order (first found is used):</strong></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X-Real-IP</span></code> header (recommended for reverse proxies)</p></li>
<li><p>Rightmost IP in <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> header</p></li>
<li><p>Direct connection IP (fallback)</p></li>
</ol>
<p><strong>Environment Variables:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Specify which header to trust for client IP</span>
</span><span data-line="2"><span class="c1"># Options: &quot;X-Real-IP&quot;, &quot;X-Forwarded-For&quot; (rightmost), or &quot;remote-addr&quot;</span>
</span><span data-line="3"><span class="nb">export</span><span class="w"> </span><span class="nv">PROXYWHIRL_CLIENT_IP_HEADER</span><span class="o">=</span><span class="s2">&quot;X-Real-IP&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="c1"># Define trusted upstream proxy IP ranges (CIDR notation)</span>
</span><span data-line="6"><span class="c1"># ProxyWhirl will only trust headers from these IPs</span>
</span><span data-line="7"><span class="nb">export</span><span class="w"> </span><span class="nv">PROXYWHIRL_TRUSTED_PROXIES</span><span class="o">=</span><span class="s2">&quot;10.0.0.0/8,172.16.0.0/12,203.0.113.50/32&quot;</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># Rate limiting per IP</span>
</span><span data-line="10"><span class="nb">export</span><span class="w"> </span><span class="nv">PROXYWHIRL_RATE_LIMIT_DEFAULT</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="c1"># requests/minute</span>
</span><span data-line="11"><span class="nb">export</span><span class="w"> </span><span class="nv">PROXYWHIRL_RATE_LIMIT_REQUEST</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="c1"># requests/minute for /api/v1/request</span>
</span></pre></div>
</div>
</section>
<section id="docker-compose-example">
<h3>Docker Compose Example<a class="headerlink" href="#docker-compose-example" title="Link to this heading"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>
</span><span data-line="2">
</span><span data-line="3"><span class="nt">services</span><span class="p">:</span>
</span><span data-line="4"><span class="w">  </span><span class="nt">nginx</span><span class="p">:</span>
</span><span data-line="5"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:latest</span>
</span><span data-line="6"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
</span><span data-line="7"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>
</span><span data-line="8"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:443&quot;</span>
</span><span data-line="9"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
</span><span data-line="10"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./nginx.conf:/etc/nginx/nginx.conf:ro</span>
</span><span data-line="11"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./ssl:/etc/nginx/ssl:ro</span>
</span><span data-line="12"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
</span><span data-line="13"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-net</span>
</span><span data-line="14">
</span><span data-line="15"><span class="w">  </span><span class="nt">proxywhirl</span><span class="p">:</span>
</span><span data-line="16"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxywhirl-api:latest</span>
</span><span data-line="17"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
</span><span data-line="18"><span class="w">      </span><span class="nt">PROXYWHIRL_STRATEGY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;round-robin&quot;</span>
</span><span data-line="19"><span class="w">      </span><span class="nt">PROXYWHIRL_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span><span data-line="20"><span class="w">      </span><span class="nt">PROXYWHIRL_STORAGE_PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/proxies.db</span>
</span><span data-line="21"><span class="w">      </span><span class="nt">PROXYWHIRL_CLIENT_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Real-IP&quot;</span>
</span><span data-line="22"><span class="w">      </span><span class="nt">PROXYWHIRL_TRUSTED_PROXIES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10.0.0.0/8&quot;</span>
</span><span data-line="23"><span class="w">      </span><span class="nt">PROXYWHIRL_RATE_LIMIT_DEFAULT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</span><span data-line="24"><span class="w">      </span><span class="nt">PROXYWHIRL_RATE_LIMIT_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
</span><span data-line="25"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
</span><span data-line="26"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxywhirl-data:/data</span>
</span><span data-line="27"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
</span><span data-line="28"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-net</span>
</span><span data-line="29"><span class="w">    </span><span class="nt">expose</span><span class="p">:</span>
</span><span data-line="30"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
</span><span data-line="31"><span class="w">    </span><span class="nt">healthcheck</span><span class="p">:</span>
</span><span data-line="32"><span class="w">      </span><span class="nt">test</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;CMD&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;curl&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-f&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;http://localhost:8000/api/v1/health&quot;</span><span class="p p-Indicator">]</span>
</span><span data-line="33"><span class="w">      </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30s</span>
</span><span data-line="34"><span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10s</span>
</span><span data-line="35"><span class="w">      </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span data-line="36">
</span><span data-line="37"><span class="nt">networks</span><span class="p">:</span>
</span><span data-line="38"><span class="w">  </span><span class="nt">secure-net</span><span class="p">:</span>
</span><span data-line="39"><span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge</span>
</span><span data-line="40">
</span><span data-line="41"><span class="nt">volumes</span><span class="p">:</span>
</span><span data-line="42"><span class="w">  </span><span class="nt">proxywhirl-data</span><span class="p">:</span>
</span></pre></div>
</div>
</section>
</section>
<section id="security-checklist">
<h2>Security Checklist<a class="headerlink" href="#security-checklist" title="Link to this heading"></a></h2>
<p><strong>Before Production Deployment:</strong></p>
<ul class="simple">
<li><p>[ ] <strong>Reverse proxy installed</strong> between internet and ProxyWhirl</p></li>
<li><p>[ ] <strong>Untrusted X-Forwarded-For headers cleared</strong> by reverse proxy</p></li>
<li><p>[ ] <strong>X-Real-IP or X-Forwarded-For set</strong> by reverse proxy with real client IP</p></li>
<li><p>[ ] <strong>ProxyWhirl configured</strong> to read correct header (X-Real-IP preferred)</p></li>
<li><p>[ ] <strong>Trusted proxy IP ranges configured</strong> in ProxyWhirl</p></li>
<li><p>[ ] <strong>Rate limiting tested</strong> with spoofed headers (verified to fail)</p></li>
<li><p>[ ] <strong>Access logs reviewed</strong> to verify correct client IP attribution</p></li>
<li><p>[ ] <strong>Direct internet access blocked</strong> (no exposure on :8000 from outside)</p></li>
<li><p>[ ] <strong>Security group/firewall rules</strong> restrict to reverse proxy only</p></li>
<li><p>[ ] <strong>HTTPS/TLS enabled</strong> on reverse proxy (use Lets Encrypt or managed service)</p></li>
<li><p>[ ] <strong>API key authentication enabled</strong> if sensitive operations are exposed</p></li>
<li><p>[ ] <strong>CORS origins restricted</strong> to known domains</p></li>
<li><p>[ ] <strong>Regular security updates</strong> applied (nginx, HAProxy, ProxyWhirl)</p></li>
</ul>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h2>
<section id="rate-limiting-not-working">
<h3>Rate Limiting Not Working<a class="headerlink" href="#rate-limiting-not-working" title="Link to this heading"></a></h3>
<p><strong>Symptom:</strong> Requests with different <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> values bypass rate limit</p>
<p><strong>Solution:</strong></p>
<ol class="arabic">
<li><p>Verify reverse proxy is clearing client-provided <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code></p></li>
<li><p>Check ProxyWhirl logs for detected client IP:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Enable debug logging</span>
</span><span data-line="2"><span class="nb">export</span><span class="w"> </span><span class="nv">LOGLEVEL</span><span class="o">=</span>DEBUG
</span></pre></div>
</div>
</li>
<li><p>Test with direct request (no reverse proxy):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1">curl<span class="w"> </span>http://localhost:8000/api/v1/proxies<span class="w"> </span><span class="se">\</span>
</span><span data-line="2"><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;X-Forwarded-For: 1.2.3.4&quot;</span>
</span><span data-line="3"><span class="c1"># Should rate limit based on real connection IP, not header value</span>
</span></pre></div>
</div>
</li>
</ol>
</section>
<section id="metrics-showing-wrong-client-ips">
<h3>Metrics Showing Wrong Client IPs<a class="headerlink" href="#metrics-showing-wrong-client-ips" title="Link to this heading"></a></h3>
<p><strong>Symptom:</strong> Metrics endpoint shows incorrect client IP distribution</p>
<p><strong>Solution:</strong></p>
<ol class="arabic">
<li><p>Verify <code class="docutils literal notranslate"><span class="pre">PROXYWHIRL_CLIENT_IP_HEADER</span></code> environment variable</p></li>
<li><p>Check reverse proxy is setting the header correctly:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1">curl<span class="w"> </span>-v<span class="w"> </span>http://localhost/api/v1/metrics
</span><span data-line="2"><span class="c1"># Look at response headers from reverse proxy</span>
</span></pre></div>
</div>
</li>
<li><p>Review reverse proxy logs for X-Real-IP values being set</p></li>
</ol>
</section>
<section id="connection-refused-behind-reverse-proxy">
<h3>Connection Refused Behind Reverse Proxy<a class="headerlink" href="#connection-refused-behind-reverse-proxy" title="Link to this heading"></a></h3>
<p><strong>Symptom:</strong> HTTP 502 Bad Gateway</p>
<p><strong>Solution:</strong></p>
<ol class="arabic">
<li><p>Verify ProxyWhirl is running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1">docker<span class="w"> </span>logs<span class="w"> </span>proxywhirl-container
</span></pre></div>
</div>
</li>
<li><p>Test direct connection:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1">curl<span class="w"> </span>http://localhost:8000/api/v1/health
</span></pre></div>
</div>
</li>
<li><p>Check reverse proxy network connectivity</p></li>
<li><p>Review reverse proxy logs for backend errors</p></li>
</ol>
</section>
<section id="ssl-certificate-errors">
<h3>SSL Certificate Errors<a class="headerlink" href="#ssl-certificate-errors" title="Link to this heading"></a></h3>
<p><strong>Symptom:</strong> HTTPS requests return certificate warnings</p>
<p><strong>Solution:</strong></p>
<ol class="arabic simple">
<li><p>Obtain valid certificate (Lets Encrypt recommended)</p></li>
<li><p>Configure reverse proxy with certificate</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">X-Forwarded-Proto:</span> <span class="pre">https</span></code> in reverse proxy configuration</p></li>
<li><p>ProxyWhirl will correctly generate links with <code class="docutils literal notranslate"><span class="pre">https://</span></code></p></li>
</ol>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<section id="security-standards">
<h3>Security Standards<a class="headerlink" href="#security-standards" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc7239">RFC 7239 - Forwarded HTTP Extension</a></strong> - Standard for HTTP forwarding headers</p></li>
<li><p><strong><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/X-Forwarded-For">MDN X-Forwarded-For</a></strong> - X-Forwarded-For header documentation</p></li>
<li><p><strong><a class="reference external" href="https://owasp.org/www-community/attacks/HTTP_Response_Splitting">OWASP HTTP Response Splitting</a></strong> - Header injection attacks</p></li>
<li><p><strong><a class="reference external" href="https://owasp.org/www-project-web-security-testing-guide/">OWASP Web Security Testing Guide</a></strong> - HTTP request validation best practices</p></li>
</ul>
</section>
<section id="reverse-proxy-documentation">
<h3>Reverse Proxy Documentation<a class="headerlink" href="#reverse-proxy-documentation" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html">Nginx Proxy Module</a></strong> - Official proxy configuration</p></li>
<li><p><strong><a class="reference external" href="https://nginx.org/en/docs/http/ngx_http_realip_module.html">Nginx Real IP Module</a></strong> - Real IP extraction</p></li>
<li><p><strong><a class="reference external" href="https://caddyserver.com/docs/caddyfile/directives/reverse_proxy">Caddy Reverse Proxy</a></strong> - Caddy proxy documentation</p></li>
<li><p><strong><a class="reference external" href="https://docs.haproxy.org/">HAProxy Documentation</a></strong> - HAProxy documentation</p></li>
<li><p><strong><a class="reference external" href="https://doc.traefik.io/traefik/middlewares/http/overview/">Traefik Middleware</a></strong> - Traefik middleware reference</p></li>
</ul>
</section>
<section id="cloud-documentation">
<h3>Cloud Documentation<a class="headerlink" href="#cloud-documentation" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/">AWS ALB Documentation</a></strong> - AWS Application Load Balancer</p></li>
<li><p><strong><a class="reference external" href="https://cloud.google.com/load-balancing/docs">GCP Load Balancing</a></strong> - Google Cloud Load Balancer</p></li>
<li><p><strong><a class="reference external" href="https://docs.microsoft.com/en-us/azure/application-gateway/">Azure Application Gateway</a></strong> - Azure gateway documentation</p></li>
</ul>
</section>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="retry-failover.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">Retry &amp; Failover Guide</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="cli-reference.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">CLI Reference</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2026, Wyatt Walsh</p>
  
  <p>
    Made with
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials">
<a href="https://github.com/wyattowalsh/proxywhirl" aria-label="GitHub">
  <iconify-icon icon="simple-icons:github"></iconify-icon>
</a></div>
    </div>
  </div>
</footer>
      <script src="../_static/documentation_options.js?v=a58bc63e"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../_static/shibuya.js?v=cac61aee"></script></body>
</html>