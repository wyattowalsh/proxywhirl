<!DOCTYPE html>
<html lang="en" data-accent-color="violet" data-content_root="../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Caching Subsystem Guide - ProxyWhirl Documentation</title><link rel="shortcut icon" href="../_static/favicon.svg"/><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Retry &amp; Failover Guide" href="retry-failover.html" /><link rel="prev" title="Advanced Rotation Strategies" href="advanced-strategies.html" />
      <link rel="canonical" href="https://proxywhirl.readthedocs.io/guides/caching.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=e1a1ceaf" />
    <link rel="stylesheet" type="text/css" href="../_static/shibuya.css?v=44020203" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link media="print" rel="stylesheet" type="text/css" href="../_static/print.css?v=20ff2c19" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b31b09b0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://proxywhirl.readthedocs.io/guides/caching.html"/>
  <meta property="og:title" content="Caching Subsystem Guide"/>
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:creator" content="@wyaborern"/>
<meta name="twitter:site" content="@wyaborern"/>
  </head>
<body>
<a class="skip-link" href="#main-content">Skip to content</a>
<header class="pw-navbar">
  <div class="pw-navbar-inner">
    
    <button class="pw-navbar-sidebar-toggle js-menu" aria-controls="lside" aria-expanded="false" aria-label="Toggle navigation" type="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
    </button>

    
    <a href="../index.html" class="pw-navbar-brand">
      <svg class="pw-navbar-logo" viewBox="0 0 100 100" aria-hidden="true">
        <defs>
          <linearGradient id="pw-logo-grad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#06b6d4"/>
            <stop offset="50%" stop-color="#3b82f6"/>
            <stop offset="100%" stop-color="#8b5cf6"/>
          </linearGradient>
        </defs>
        <circle cx="50" cy="50" r="44" fill="none" stroke="url(#pw-logo-grad)" stroke-width="6" stroke-linecap="round" stroke-dasharray="60 30"/>
        <g fill="url(#pw-logo-grad)">
          <path d="M50 18 L58 30 L52 30 L52 42 L48 42 L48 30 L42 30 Z"/>
          <path d="M82 50 L70 58 L70 52 L58 52 L58 48 L70 48 L70 42 Z"/>
          <path d="M50 82 L42 70 L48 70 L48 58 L52 58 L52 70 L58 70 Z"/>
          <path d="M18 50 L30 42 L30 48 L42 48 L42 52 L30 52 L30 58 Z"/>
        </g>
        <circle cx="50" cy="50" r="8" fill="url(#pw-logo-grad)"/>
      </svg>
      <strong>ProxyWhirl</strong>
    </a>

    
    <nav class="pw-navbar-links" aria-label="Main navigation">
      <a href="../getting-started/index.html" class="pw-navbar-link" data-section="getting-started">
        Getting Started
      </a>
      <a href="index.html" class="pw-navbar-link" data-section="guides">
        Guides
      </a>
      <a href="../reference/index.html" class="pw-navbar-link" data-section="reference">
        Reference
      </a>
      <a href="../project/index.html" class="pw-navbar-link" data-section="project">
        Project
      </a>
    </nav>

    
    <div class="pw-navbar-actions">
      
      <button class="pw-navbar-btn" id="pw-theme-toggle" type="button" aria-label="Toggle theme" aria-pressed="false">
        <svg class="pw-icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
        <svg class="pw-icon-moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
      </button>

      
      <a href="https://github.com/wyattowalsh/proxywhirl" class="pw-navbar-btn pw-navbar-github" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
      </a>
    </div>
  </div>
</header>
<div id="main-content"></div>

<script>
(function() {
  /* Theme toggle */
  var toggle = document.getElementById('pw-theme-toggle');
  if (toggle) {
    /* Set initial aria-pressed based on current theme */
    var currentlyDark = document.documentElement.classList.contains('dark');
    toggle.setAttribute('aria-pressed', currentlyDark ? 'true' : 'false');

    toggle.addEventListener('click', function() {
      var isDark = document.documentElement.classList.contains('dark');
      var next = isDark ? 'light' : 'dark';
      localStorage._theme = next;
      if (typeof setColorMode === 'function') {
        setColorMode(next);
      } else {
        var html = document.documentElement;
        html.classList.remove('dark', 'light');
        html.classList.add(next);
        html.setAttribute('data-color-mode', next);
      }
      toggle.setAttribute('aria-pressed', next === 'dark' ? 'true' : 'false');
    });
  }

  /* Active nav link detection — highlight current section */
  var path = window.location.pathname;
  var links = document.querySelectorAll('.pw-navbar-link[data-section]');
  links.forEach(function(link) {
    var section = link.getAttribute('data-section');
    if (path.indexOf('/' + section) !== -1) {
      link.classList.add('active');
    }
  });
  /* Mark home page — none active, or all inactive is fine */
})();
</script>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="2"><ul class="current">
<li class="toctree-l1 _expand"><a class="reference internal" href="../getting-started/index.html">Getting Started</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#what-youll-build">What You&#8217;ll Build</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#installation">Installation</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#quick-start">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#basic-usage-sync">Basic Usage (sync)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#async-usage">Async Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#context-manager-pattern">Context Manager Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#authenticated-proxies">Authenticated Proxies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#using-free-proxy-lists">Using Free Proxy Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/index.html#fetching-proxies-programmatically">Fetching Proxies Programmatically</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#choosing-a-rotation-strategy">Choosing a Rotation Strategy</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#configuring-retry-and-circuit-breakers">Configuring Retry and Circuit Breakers</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#monitoring-your-pool">Monitoring Your Pool</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#next-steps">Next Steps</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../getting-started/index.html#for-contributors">For Contributors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/rotation-strategies.html">Rotation Strategies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#bootstrap-a-rotator">Bootstrap a Rotator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#decision-matrix">Decision Matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#quick-pick-guide">Quick-Pick Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#strategy-reference">Strategy Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#comparison-at-a-glance">Comparison At a Glance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#hot-swapping-strategies">Hot-Swapping Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#observe-the-pool">Observe the Pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#building-a-custom-strategy">Building a Custom Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/rotation-strategies.html#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Guides</a><ul class="current">
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#choosing-a-guide">Choosing a Guide</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#client-concurrency">Client &amp; Concurrency</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#resilience-caching">Resilience &amp; Caching</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#operations-deployment">Operations &amp; Deployment</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#automation-ai">Automation &amp; AI</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="async-client.html">Async Client Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#when-to-use-async-vs-sync">When to Use Async vs Sync</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#context-manager-usage">Context Manager Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#http-request-methods">HTTP Request Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#proxy-management">Proxy Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#hot-swapping-strategies">Hot-Swapping Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#concurrent-requests-with-asyncio-gather">Concurrent Requests with asyncio.gather</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#asyncio-integration-patterns">Asyncio Integration Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#comparison-async-vs-sync">Comparison: Async vs Sync</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#best-practices-and-common-patterns">Best Practices and Common Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="async-client.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="advanced-strategies.html">Advanced Rotation Strategies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#performance-based-strategy">Performance-Based Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#session-persistence-strategy">Session Persistence Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#geo-targeted-strategy">Geo-Targeted Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#cost-aware-strategy">Cost-Aware Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#composite-strategy">Composite Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#strategy-registry">Strategy Registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#selectioncontext">SelectionContext</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#strategyconfig">StrategyConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#custom-strategy-implementation">Custom Strategy Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#strategyregistry-usage">StrategyRegistry Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#id16">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#testing-strategies">Testing Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#performance-benchmarks">Performance Benchmarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced-strategies.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Caching Subsystem Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-components">Core Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#credential-encryption">Credential Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ttl-and-expiration">TTL and Expiration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#health-invalidation">Health Invalidation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#migration-from-jsonl-l2-cache">Migration from JSONL L2 Cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cache-warming">Cache Warming</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance-tuning">Performance Tuning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cli-integration">CLI Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-complete-cache-setup">Example: Complete Cache Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retry-failover.html">Retry &amp; Failover Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#when-to-use-retry-vs-failover">When to Use Retry vs Failover</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#retrypolicy-configuration">RetryPolicy Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#circuit-breaker-configuration">Circuit Breaker Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#intelligent-proxy-selection">Intelligent Proxy Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#retrymetrics-and-observability">RetryMetrics and Observability</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#retryexecutor-deep-dive">RetryExecutor Deep Dive</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#integration-with-proxyrotator">Integration with ProxyRotator</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#advanced-patterns">Advanced Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#performance-impact">Performance Impact</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#see-also">See Also</a></li>
<li class="toctree-l4"><a class="reference internal" href="retry-failover.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deployment-security.html">Deployment Security &amp; Reverse Proxy Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deployment-security.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment-security.html#x-forwarded-for-security">X-Forwarded-For Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment-security.html#reverse-proxy-configurations">Reverse Proxy Configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment-security.html#proxywhirl-configuration">ProxyWhirl Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment-security.html#security-checklist">Security Checklist</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment-security.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment-security.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cli-reference.html">CLI Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#global-options">Global Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#commands">Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#output-formats">Output Formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#configuration-file">Configuration File</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#advanced-usage">Advanced Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#exit-codes">Exit Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="cli-reference.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="automation.html">Automation &amp; CI/CD Runbook</a><ul>
<li class="toctree-l4"><a class="reference internal" href="automation.html#pre-flight-checks">Pre-flight Checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#github-actions-ci-pipeline">GitHub Actions CI Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#cron-based-proxy-fetching">Cron-Based Proxy Fetching</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#docker-deployment">Docker Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#integration-testing-patterns">Integration Testing Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#smoke-tests-for-docs-examples">Smoke Tests for Docs Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#automating-releases">Automating Releases</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#docsearch-credentials">DocSearch Credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#ci-stage-summary">CI Stage Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="automation.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcp-server.html">MCP Server Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#quick-start">Quick Start</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#the-proxywhirl-tool">The <code class="docutils literal notranslate"><span class="pre">proxywhirl</span></code> Tool</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#prompts">Prompts</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#authentication">Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#progress-reporting">Progress Reporting</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#transport-options">Transport Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#integration-with-claude-desktop">Integration with Claude Desktop</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#programmatic-usage">Programmatic Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#lifecycle-management">Lifecycle Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcp-server.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 _expand"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/index.html#quick-lookup">Quick Lookup</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/index.html#api-surfaces">API Surfaces</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/index.html#configuration-error-handling">Configuration &amp; Error Handling</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/index.html#subsystem-apis">Subsystem APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html">ProxyWhirl REST API Usage Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#authentication">Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#middleware">Middleware</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#endpoint-reference">Endpoint Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#rate-limiting">Rate Limiting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#performance-tips">Performance Tips</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#security-best-practices">Security Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#deployment-examples">Deployment Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#x-forwarded-for-security-checklist">X-Forwarded-For Security Checklist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#security-references">Security References</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#see-also">See Also</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#support">Support</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html">Python API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#core-classes">Core Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#rotation-strategies">Rotation Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#data-models">Data Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#cache-components">Cache Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#retry-failover">Retry &amp; Failover</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#parsers">Parsers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#enumerations">Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#built-in-proxy-sources">Built-in Proxy Sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#exceptions">Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#type-annotations">Type Annotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#version">Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html">Configuration Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#configuration-discovery">Configuration Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#toml-configuration-format">TOML Configuration Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#configuration-classes">Configuration Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#programmatic-configuration">Programmatic Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#validation-rules">Validation Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#security-best-practices">Security Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#configuration-examples">Configuration Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#migration-from-legacy-config">Migration from Legacy Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html">Exceptions Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#exception-hierarchy">Exception Hierarchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxyerrorcode-enum">ProxyErrorCode Enum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#error-codes">Error Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#exception-reference">Exception Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#error-handling-patterns">Error Handling Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html">Cache API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#data-models">Data Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#tier-implementations">Tier Implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#utilities">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html">Rate Limiting API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#core-classes">Core Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#data-models">Data Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#integration-with-monitoring">Integration with Monitoring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#sphinx-integration">Sphinx Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#common-patterns">Common Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#faq">FAQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 _expand"><a class="reference internal" href="../project/index.html">Project</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#development-setup">Development Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#clone-install">Clone &amp; Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#verify-installation">Verify Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#make-commands">Make Commands</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#contributing">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#workflow">Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#branch-naming">Branch Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#commit-convention">Commit Convention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#code-style">Code Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#pre-commit-hooks">Pre-commit Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#testing-guidelines">Testing Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#extending-with-custom-strategies">Extending with Custom Strategies</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#ci-cd-pipelines">CI/CD Pipelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#quality-gate-pipeline">Quality Gate Pipeline</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#architecture">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#module-map">Module Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#key-exports">Key Exports</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#current-health">Current Health</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#changelog-highlights">Changelog Highlights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#recent">Recent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#phase-completion-status">Phase Completion Status</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#license">License</a></li>
</ul>
</li>
</ul>
        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3><ul>
<li><a class="reference internal" href="#architecture-overview">Architecture Overview</a><ul>
<li><a class="reference internal" href="#tier-promotion-demotion">Tier Promotion &amp; Demotion</a></li>
<li><a class="reference internal" href="#l2-backend-selection">L2 Backend Selection</a></li>
<li><a class="reference internal" href="#l2-sqlite-vs-l3-sqlite-differences">L2 (SQLite) vs L3 SQLite Differences</a></li>
</ul>
</li>
<li><a class="reference internal" href="#core-components">Core Components</a><ul>
<li><a class="reference internal" href="#cachemanager">CacheManager</a></li>
<li><a class="reference internal" href="#cacheentry">CacheEntry</a></li>
<li><a class="reference internal" href="#cacheconfig">CacheConfig</a></li>
<li><a class="reference internal" href="#cachestatistics">CacheStatistics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#credential-encryption">Credential Encryption</a><ul>
<li><a class="reference internal" href="#encryption-setup">Encryption Setup</a></li>
<li><a class="reference internal" href="#key-rotation">Key Rotation</a></li>
<li><a class="reference internal" href="#encryption-behavior">Encryption Behavior</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ttl-and-expiration">TTL and Expiration</a><ul>
<li><a class="reference internal" href="#ttl-configuration">TTL Configuration</a></li>
<li><a class="reference internal" href="#expiration-strategies">Expiration Strategies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#health-invalidation">Health Invalidation</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#invalidation-workflow">Invalidation Workflow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#migration-from-jsonl-l2-cache">Migration from JSONL L2 Cache</a><ul>
<li><a class="reference internal" href="#migrating-legacy-jsonl-caches">Migrating Legacy JSONL Caches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cache-warming">Cache Warming</a><ul>
<li><a class="reference internal" href="#supported-formats">Supported Formats</a></li>
<li><a class="reference internal" href="#warming-from-file">Warming from File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performance-tuning">Performance Tuning</a><ul>
<li><a class="reference internal" href="#tier-sizing-recommendations">Tier Sizing Recommendations</a></li>
<li><a class="reference internal" href="#eviction-policy-selection">Eviction Policy Selection</a></li>
<li><a class="reference internal" href="#performance-characteristics">Performance Characteristics</a></li>
<li><a class="reference internal" href="#graceful-degradation">Graceful Degradation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cli-integration">CLI Integration</a></li>
<li><a class="reference internal" href="#best-practices">Best Practices</a><ul>
<li><a class="reference internal" href="#security">Security</a></li>
<li><a class="reference internal" href="#performance">Performance</a></li>
<li><a class="reference internal" href="#reliability">Reliability</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-complete-cache-setup">Example: Complete Cache Setup</a></li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#low-hit-rates">Low Hit Rates</a></li>
<li><a class="reference internal" href="#high-memory-usage">High Memory Usage</a></li>
<li><a class="reference internal" href="#encryption-errors">Encryption Errors</a></li>
<li><a class="reference internal" href="#tier-degradation">Tier Degradation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">ProxyWhirl</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="index.html"><span itemprop="name">Guides</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">Caching Subsystem Guide</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="relative min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
  <div class="copy-page-wrapper relative pb-4 lg:absolute lg:top-8 lg:right-6 xl:right-12">
  <div id="copy-page-trigger">
    <button
      type="button"
      class="js-copy px-3 py-1 inline-flex items-center gap-1"
      data-url="https://proxywhirl.readthedocs.io/_sources/guides/caching.md.txt"
    >
      <i class="i-lucide" data-icon="copy"></i>
      <span>Copy page</span>
    </button>
    <button class="js-menu px-2 py-1" type="button" aria-label="More actions"
      aria-haspopup="menu" aria-expanded="false" aria-controls="copy-page-content">
      <i class="i-lucide chevron-down"></i>
    </button>
  </div>
  <div id="copy-page-content" role="menu" aria-orientation="vertical" aria-hidden="true">
    <div role="presentation">
      <div class="flex flex-col" role="group">
        <button class="js-copy" type="button" role="menuitem"
          data-url="https://proxywhirl.readthedocs.io/_sources/guides/caching.md.txt">
          <span class="iconify-icon">
            <i class="i-lucide" data-icon="copy"></i>
          </span>
          <span>Copy page</span>
        </button>
        <a role="menuitem" href="https://proxywhirl.readthedocs.io/_sources/guides/caching.md.txt" target="_blank" rel="nofollow"><iconify-icon icon="bi:markdown"></iconify-icon>
            <span>View as Markdown</span></a><a role="menuitem" href="https://chatgpt.com/?hints=search&q=Read%20https%3A//proxywhirl.readthedocs.io/_sources/guides/caching.md.txt%20so%20I%20can%20ask%20questions%20about%20it." target="_blank" rel="nofollow">
          <iconify-icon icon="bi:openai"></iconify-icon>
          <span>Open in ChatGPT</span>
        </a><a role="menuitem" href="https://claude.ai/new?q=Read%20https%3A//proxywhirl.readthedocs.io/_sources/guides/caching.md.txt%20so%20I%20can%20ask%20questions%20about%20it." target="_blank" rel="nofollow">
          <iconify-icon icon="bi:claude"></iconify-icon>
          <span>Open in Claude</span>
        </a></div>
    </div>
  </div>
</div><article class="yue dark-code" role="main">
          <section id="caching-subsystem-guide">
<h1>Caching Subsystem Guide<a class="headerlink" href="#caching-subsystem-guide" title="Link to this heading">¶</a></h1>
<p>ProxyWhirl implements a sophisticated three-tier caching system for proxy persistence, performance optimization, and credential security. This guide covers architecture, configuration, encryption, and performance tuning.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#architecture-overview" id="id1">Architecture Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#tier-promotion-demotion" id="id2">Tier Promotion &amp; Demotion</a></p></li>
<li><p><a class="reference internal" href="#l2-backend-selection" id="id3">L2 Backend Selection</a></p></li>
<li><p><a class="reference internal" href="#l2-sqlite-vs-l3-sqlite-differences" id="id4">L2 (SQLite) vs L3 SQLite Differences</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#core-components" id="id5">Core Components</a></p>
<ul>
<li><p><a class="reference internal" href="#cachemanager" id="id6">CacheManager</a></p></li>
<li><p><a class="reference internal" href="#cacheentry" id="id7">CacheEntry</a></p></li>
<li><p><a class="reference internal" href="#cacheconfig" id="id8">CacheConfig</a></p></li>
<li><p><a class="reference internal" href="#cachestatistics" id="id9">CacheStatistics</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#credential-encryption" id="id10">Credential Encryption</a></p>
<ul>
<li><p><a class="reference internal" href="#encryption-setup" id="id11">Encryption Setup</a></p></li>
<li><p><a class="reference internal" href="#key-rotation" id="id12">Key Rotation</a></p></li>
<li><p><a class="reference internal" href="#encryption-behavior" id="id13">Encryption Behavior</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#ttl-and-expiration" id="id14">TTL and Expiration</a></p>
<ul>
<li><p><a class="reference internal" href="#ttl-configuration" id="id15">TTL Configuration</a></p></li>
<li><p><a class="reference internal" href="#expiration-strategies" id="id16">Expiration Strategies</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#health-invalidation" id="id17">Health Invalidation</a></p>
<ul>
<li><p><a class="reference internal" href="#configuration" id="id18">Configuration</a></p></li>
<li><p><a class="reference internal" href="#invalidation-workflow" id="id19">Invalidation Workflow</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#migration-from-jsonl-l2-cache" id="id20">Migration from JSONL L2 Cache</a></p>
<ul>
<li><p><a class="reference internal" href="#migrating-legacy-jsonl-caches" id="id21">Migrating Legacy JSONL Caches</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cache-warming" id="id22">Cache Warming</a></p>
<ul>
<li><p><a class="reference internal" href="#supported-formats" id="id23">Supported Formats</a></p></li>
<li><p><a class="reference internal" href="#warming-from-file" id="id24">Warming from File</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#performance-tuning" id="id25">Performance Tuning</a></p>
<ul>
<li><p><a class="reference internal" href="#tier-sizing-recommendations" id="id26">Tier Sizing Recommendations</a></p></li>
<li><p><a class="reference internal" href="#eviction-policy-selection" id="id27">Eviction Policy Selection</a></p></li>
<li><p><a class="reference internal" href="#performance-characteristics" id="id28">Performance Characteristics</a></p></li>
<li><p><a class="reference internal" href="#graceful-degradation" id="id29">Graceful Degradation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cli-integration" id="id30">CLI Integration</a></p></li>
<li><p><a class="reference internal" href="#best-practices" id="id31">Best Practices</a></p>
<ul>
<li><p><a class="reference internal" href="#security" id="id32">Security</a></p></li>
<li><p><a class="reference internal" href="#performance" id="id33">Performance</a></p></li>
<li><p><a class="reference internal" href="#reliability" id="id34">Reliability</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#example-complete-cache-setup" id="id35">Example: Complete Cache Setup</a></p></li>
<li><p><a class="reference internal" href="#troubleshooting" id="id36">Troubleshooting</a></p>
<ul>
<li><p><a class="reference internal" href="#low-hit-rates" id="id37">Low Hit Rates</a></p></li>
<li><p><a class="reference internal" href="#high-memory-usage" id="id38">High Memory Usage</a></p></li>
<li><p><a class="reference internal" href="#encryption-errors" id="id39">Encryption Errors</a></p></li>
<li><p><a class="reference internal" href="#tier-degradation" id="id40">Tier Degradation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#see-also" id="id41">See Also</a></p></li>
</ul>
</nav>
<section id="architecture-overview">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Architecture Overview</a><a class="headerlink" href="#architecture-overview" title="Link to this heading">¶</a></h2>
<p>The caching subsystem uses a hierarchical three-tier design for optimal performance and durability:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 15.0%" />
<col style="width: 20.0%" />
<col style="width: 25.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Tier</p></th>
<th class="head"><p>Storage</p></th>
<th class="head"><p>Typical Latency</p></th>
<th class="head"><p>Capacity</p></th>
<th class="head"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>L1</strong></p></td>
<td><p>In-Memory (OrderedDict)</p></td>
<td><p>~100 ns</p></td>
<td><p>1,000 entries (default)</p></td>
<td><p>Hot proxies, LRU eviction</p></td>
</tr>
<tr class="row-odd"><td><p><strong>L2</strong></p></td>
<td><p>JSONL (default) or SQLite</p></td>
<td><p>~1-10 ms</p></td>
<td><p>5,000 entries (default)</p></td>
<td><p>Warm storage, configurable backend</p></td>
</tr>
<tr class="row-even"><td><p><strong>L3</strong></p></td>
<td><p>SQLite Database</p></td>
<td><p>~5-50 ms</p></td>
<td><p>Unlimited (default)</p></td>
<td><p>Cold storage, full queryability</p></td>
</tr>
</tbody>
</table>
</div>
<section id="tier-promotion-demotion">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Tier Promotion &amp; Demotion</a><a class="headerlink" href="#tier-promotion-demotion" title="Link to this heading">¶</a></h3>
<p>Proxies automatically promote from slower to faster tiers on access:</p>
<ul class="simple">
<li><p><strong>L3 → L2 → L1</strong>: On cache hit, entry copies to higher tiers</p></li>
<li><p><strong>L1 → L2 → L3</strong>: When L1 is full, LRU entry evicts to lower tiers</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This design minimizes latency for frequently-used proxies while maintaining full persistence in L3.</p>
</div>
</section>
<section id="l2-backend-selection">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">L2 Backend Selection</a><a class="headerlink" href="#l2-backend-selection" title="Link to this heading">¶</a></h3>
<p>L2 supports two backends, configured via <code class="docutils literal notranslate"><span class="pre">l2_backend</span></code> in <code class="docutils literal notranslate"><span class="pre">CacheConfig</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">L2BackendType</span>
</span><span data-line="2">
</span><span data-line="3"><span class="c1"># JSONL backend (default) -- file-based, human-readable, best for &lt;10K entries</span>
</span><span data-line="4"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span><span class="n">l2_backend</span><span class="o">=</span><span class="n">L2BackendType</span><span class="o">.</span><span class="n">JSONL</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># SQLite backend -- faster for &gt;10K entries, O(log n) indexed lookups</span>
</span><span data-line="7"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span><span class="n">l2_backend</span><span class="o">=</span><span class="n">L2BackendType</span><span class="o">.</span><span class="n">SQLITE</span><span class="p">)</span>
</span></pre></div>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Backend</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Best For</p></th>
<th class="head"><p>Lookup</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">JSONL</span></code> (default)</p></td>
<td><p>Sharded JSON Lines files</p></td>
<td><p>&lt;10K entries, portability</p></td>
<td><p>O(n) scan</p></td>
<td><p>Human-readable, file-locked</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SQLITE</span></code></p></td>
<td><p>SQLite database (<code class="docutils literal notranslate"><span class="pre">l2_cache.db</span></code>)</p></td>
<td><p>&gt;10K entries, concurrency</p></td>
<td><p>O(log n) B-tree</p></td>
<td><p>Atomic operations</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="l2-sqlite-vs-l3-sqlite-differences">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">L2 (SQLite) vs L3 SQLite Differences</a><a class="headerlink" href="#l2-sqlite-vs-l3-sqlite-differences" title="Link to this heading">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This comparison only applies when <code class="docutils literal notranslate"><span class="pre">l2_backend=L2BackendType.SQLITE</span></code>. When using the default JSONL backend, L2 uses sharded <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> files instead of SQLite.</p>
</div>
<p>When both L2 and L3 use SQLite, they have different schemas and purposes:</p>
<p><strong>L2 (l2_cache.db)</strong> – when <code class="docutils literal notranslate"><span class="pre">l2_backend=L2BackendType.SQLITE</span></code>:</p>
<ul class="simple">
<li><p>Simpler schema optimized for fast lookups</p></li>
<li><p>Stores basic cache fields (proxy_url, credentials, TTL, health status)</p></li>
<li><p>Uses <code class="docutils literal notranslate"><span class="pre">l2_cache</span></code> table</p></li>
<li><p>Designed for ~5,000 entries with LRU eviction</p></li>
<li><p>Separate database file in cache directory</p></li>
</ul>
<p><strong>L3 (proxywhirl.db)</strong>:</p>
<ul class="simple">
<li><p>Full schema with health monitoring fields</p></li>
<li><p>Includes <code class="docutils literal notranslate"><span class="pre">cache_entries</span></code> table with health check history</p></li>
<li><p>Additional <code class="docutils literal notranslate"><span class="pre">health_history</span></code> table for tracking check results over time</p></li>
<li><p>Unlimited capacity (no eviction)</p></li>
<li><p>Main application database</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using the SQLite L2 backend, the dual-SQLite design provides performance benefits:</p>
<ul class="simple">
<li><p>L2 uses a lighter schema for faster writes during rotation</p></li>
<li><p>L3 maintains full historical data for analytics and monitoring</p></li>
<li><p>Both use B-tree indexes for O(log n) lookups</p></li>
</ul>
</div>
</section>
</section>
<section id="core-components">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Core Components</a><a class="headerlink" href="#core-components" title="Link to this heading">¶</a></h2>
<section id="cachemanager">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">CacheManager</a><a class="headerlink" href="#cachemanager" title="Link to this heading">¶</a></h3>
<p>Central orchestrator for all cache operations across tiers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">CacheManager</span><span class="p">,</span> <span class="n">CacheConfig</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="4">    <span class="n">default_ttl_seconds</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">l1_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
</span><span data-line="6">    <span class="n">l2_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">5000</span><span class="p">),</span>
</span><span data-line="7">    <span class="n">l3_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>  <span class="c1"># unlimited</span>
</span><span data-line="8"><span class="p">)</span>
</span><span data-line="9">
</span><span data-line="10"><span class="n">manager</span> <span class="o">=</span> <span class="n">CacheManager</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Key Methods:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get(key)</span></code>: Retrieve entry with automatic tier promotion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">put(key,</span> <span class="pre">entry)</span></code>: Store entry in all enabled tiers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete(key)</span></code>: Remove entry from all tiers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">invalidate_by_health(key)</span></code>: Mark unhealthy and evict if threshold exceeded</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clear()</span></code>: Remove all entries from all tiers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_statistics()</span></code>: Retrieve hit rates, sizes, and degradation status</p></li>
</ul>
</section>
<section id="cacheentry">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">CacheEntry</a><a class="headerlink" href="#cacheentry" title="Link to this heading">¶</a></h3>
<p>Pydantic model representing a single cached proxy with metadata.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">CacheEntry</span><span class="p">,</span> <span class="n">HealthStatus</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">SecretStr</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span><span class="p">,</span> <span class="n">timedelta</span>
</span><span data-line="4">
</span><span data-line="5"><span class="n">entry</span> <span class="o">=</span> <span class="n">CacheEntry</span><span class="p">(</span>
</span><span data-line="6">    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span>
</span><span data-line="7">    <span class="n">proxy_url</span><span class="o">=</span><span class="s2">&quot;http://proxy.example.com:8080&quot;</span><span class="p">,</span>
</span><span data-line="8">    <span class="n">username</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">),</span>
</span><span data-line="9">    <span class="n">password</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;pass&quot;</span><span class="p">),</span>
</span><span data-line="10">    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;fetched&quot;</span><span class="p">,</span>
</span><span data-line="11">    <span class="n">fetch_time</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
</span><span data-line="12">    <span class="n">ttl_seconds</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
</span><span data-line="13">    <span class="n">expires_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</span><span data-line="14">    <span class="n">health_status</span><span class="o">=</span><span class="n">HealthStatus</span><span class="o">.</span><span class="n">HEALTHY</span><span class="p">,</span>
</span><span data-line="15">    <span class="n">access_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">last_accessed</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
</span><span data-line="17"><span class="p">)</span>
</span><span data-line="18">
</span><span data-line="19"><span class="c1"># Check expiration</span>
</span><span data-line="20"><span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_expired</span><span class="p">:</span>
</span><span data-line="21">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Entry expired&quot;</span><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="c1"># Check health</span>
</span><span data-line="24"><span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_healthy</span><span class="p">:</span>
</span><span data-line="25">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Proxy is healthy&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Key Fields:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code>: SHA256 hash of proxy URL (first 16 chars)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proxy_url</span></code>: Full proxy URL (scheme://host:port)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">username</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>: SecretStr in memory, encrypted at rest</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ttl_seconds</span></code>, <code class="docutils literal notranslate"><span class="pre">expires_at</span></code>: Time-to-live configuration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">health_status</span></code>: HEALTHY | UNHEALTHY | UNKNOWN</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">failure_count</span></code>: Consecutive failures for health invalidation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">access_count</span></code>, <code class="docutils literal notranslate"><span class="pre">last_accessed</span></code>: Access tracking for LRU</p></li>
</ul>
<p><strong>Health Monitoring Fields</strong> (Feature 006):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">last_health_check</span></code>: Last health check timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">consecutive_health_failures</span></code>: Consecutive health check failures</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">consecutive_health_successes</span></code>: Consecutive successful checks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">recovery_attempt</span></code>: Current recovery attempt count</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">next_check_time</span></code>: Scheduled next health check</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_health_error</span></code>: Last health check error message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_health_checks</span></code>: Total health checks performed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_health_check_failures</span></code>: Total failures across lifetime</p></li>
</ul>
</section>
<section id="cacheconfig">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">CacheConfig</a><a class="headerlink" href="#cacheconfig" title="Link to this heading">¶</a></h3>
<p>Comprehensive configuration for cache behavior and tier settings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">CacheConfig</span><span class="p">,</span> <span class="n">CacheTierConfig</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">L2BackendType</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">SecretStr</span>
</span><span data-line="4">
</span><span data-line="5"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="6">    <span class="c1"># Tier configuration</span>
</span><span data-line="7">    <span class="n">l1_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span>
</span><span data-line="8">        <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="9">        <span class="n">max_entries</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
</span><span data-line="10">        <span class="n">eviction_policy</span><span class="o">=</span><span class="s2">&quot;lru&quot;</span><span class="p">,</span>  <span class="c1"># lru | lfu | fifo</span>
</span><span data-line="11">    <span class="p">),</span>
</span><span data-line="12">    <span class="n">l2_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span>
</span><span data-line="13">        <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="14">        <span class="n">max_entries</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
</span><span data-line="15">        <span class="n">eviction_policy</span><span class="o">=</span><span class="s2">&quot;lru&quot;</span><span class="p">,</span>
</span><span data-line="16">    <span class="p">),</span>
</span><span data-line="17">    <span class="n">l2_backend</span><span class="o">=</span><span class="n">L2BackendType</span><span class="o">.</span><span class="n">JSONL</span><span class="p">,</span>  <span class="c1"># or L2BackendType.SQLITE</span>
</span><span data-line="18">    <span class="n">l3_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span>
</span><span data-line="19">        <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="20">        <span class="n">max_entries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># unlimited</span>
</span><span data-line="21">        <span class="n">eviction_policy</span><span class="o">=</span><span class="s2">&quot;lru&quot;</span><span class="p">,</span>
</span><span data-line="22">    <span class="p">),</span>
</span><span data-line="23">
</span><span data-line="24">    <span class="c1"># TTL configuration</span>
</span><span data-line="25">    <span class="n">default_ttl_seconds</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
</span><span data-line="26">    <span class="n">ttl_cleanup_interval</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
</span><span data-line="27">    <span class="n">enable_background_cleanup</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="28">    <span class="n">cleanup_interval_seconds</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
</span><span data-line="29">    <span class="n">per_source_ttl</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="30">        <span class="s2">&quot;premium&quot;</span><span class="p">:</span> <span class="mi">7200</span><span class="p">,</span>
</span><span data-line="31">        <span class="s2">&quot;free&quot;</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span>
</span><span data-line="32">    <span class="p">},</span>
</span><span data-line="33">
</span><span data-line="34">    <span class="c1"># Storage paths</span>
</span><span data-line="35">    <span class="n">l2_cache_dir</span><span class="o">=</span><span class="s2">&quot;.cache/proxies&quot;</span><span class="p">,</span>           <span class="c1"># L2 SQLite: .cache/proxies/l2_cache.db</span>
</span><span data-line="36">    <span class="n">l3_database_path</span><span class="o">=</span><span class="s2">&quot;.cache/db/proxywhirl.db&quot;</span><span class="p">,</span>  <span class="c1"># L3 SQLite main database</span>
</span><span data-line="37">
</span><span data-line="38">    <span class="c1"># Encryption</span>
</span><span data-line="39">    <span class="n">encryption_key</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">),</span>  <span class="c1"># or set PROXYWHIRL_CACHE_ENCRYPTION_KEY</span>
</span><span data-line="40">
</span><span data-line="41">    <span class="c1"># Health integration</span>
</span><span data-line="42">    <span class="n">health_check_invalidation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="43">    <span class="n">failure_threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span data-line="44">
</span><span data-line="45">    <span class="c1"># Performance tuning</span>
</span><span data-line="46">    <span class="n">enable_statistics</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="47">    <span class="n">statistics_interval</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span data-line="48"><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="cachestatistics">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">CacheStatistics</a><a class="headerlink" href="#cachestatistics" title="Link to this heading">¶</a></h3>
<p>Real-time statistics across all tiers for monitoring and optimization.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">stats</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span>
</span><span data-line="2">
</span><span data-line="3"><span class="c1"># Per-tier statistics</span>
</span><span data-line="4"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L1 hit rate: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">l1_stats</span><span class="o">.</span><span class="n">hit_rate</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="5"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L2 hit rate: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">l2_stats</span><span class="o">.</span><span class="n">hit_rate</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="6"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L3 hit rate: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">l3_stats</span><span class="o">.</span><span class="n">hit_rate</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="7">
</span><span data-line="8"><span class="c1"># Aggregate statistics</span>
</span><span data-line="9"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall hit rate: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">overall_hit_rate</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="10"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total size: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">total_size</span><span class="si">}</span><span class="s2"> entries&quot;</span><span class="p">)</span>
</span><span data-line="11"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Promotions: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">promotions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="12"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Demotions: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">demotions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Degradation status</span>
</span><span data-line="15"><span class="k">if</span> <span class="n">stats</span><span class="o">.</span><span class="n">l1_degraded</span><span class="p">:</span>
</span><span data-line="16">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: L1 tier degraded&quot;</span><span class="p">)</span>
</span><span data-line="17"><span class="k">if</span> <span class="n">stats</span><span class="o">.</span><span class="n">l2_degraded</span><span class="p">:</span>
</span><span data-line="18">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: L2 tier degraded&quot;</span><span class="p">)</span>
</span><span data-line="19"><span class="k">if</span> <span class="n">stats</span><span class="o">.</span><span class="n">l3_degraded</span><span class="p">:</span>
</span><span data-line="20">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: L3 tier degraded&quot;</span><span class="p">)</span>
</span><span data-line="21">
</span><span data-line="22"><span class="c1"># Export to monitoring systems (Prometheus, Datadog, etc.)</span>
</span><span data-line="23"><span class="n">metrics</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">to_metrics_dict</span><span class="p">()</span>
</span><span data-line="24"><span class="c1"># {</span>
</span><span data-line="25"><span class="c1">#   &quot;cache.l1.hit_rate&quot;: 0.85,</span>
</span><span data-line="26"><span class="c1">#   &quot;cache.overall.hit_rate&quot;: 0.92,</span>
</span><span data-line="27"><span class="c1">#   &quot;cache.total_size&quot;: 6234.0,</span>
</span><span data-line="28"><span class="c1">#   ...</span>
</span><span data-line="29"><span class="c1"># }</span>
</span></pre></div>
</div>
<p><strong>TierStatistics Fields:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hits</span></code>, <code class="docutils literal notranslate"><span class="pre">misses</span></code>: Cache hit/miss counts</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">current_size</span></code>: Current number of entries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evictions_lru</span></code>: LRU-based evictions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evictions_ttl</span></code>: TTL-based evictions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evictions_health</span></code>: Health-based evictions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evictions_corruption</span></code>: Corruption-based evictions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hit_rate</span></code>: Computed hit rate (hits / (hits + misses))</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_evictions</span></code>: Sum of all eviction types</p></li>
</ul>
</section>
</section>
<section id="credential-encryption">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Credential Encryption</a><a class="headerlink" href="#credential-encryption" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">CredentialEncryptor</span></code> class provides Fernet symmetric encryption (AES-128-CBC + HMAC) for proxy credentials stored in L2 (JSONL files) and L3 (SQLite database).</p>
<section id="encryption-setup">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Encryption Setup</a><a class="headerlink" href="#encryption-setup" title="Link to this heading">¶</a></h3>
<p>Set the encryption key via environment variable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nb">export</span><span class="w"> </span><span class="nv">PROXYWHIRL_CACHE_ENCRYPTION_KEY</span><span class="o">=</span><span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())&quot;</span><span class="k">)</span>
</span></pre></div>
</div>
<p>Or provide it explicitly in code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">SecretStr</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="4">    <span class="n">encryption_key</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;your-fernet-key-here&quot;</span><span class="p">)</span>
</span><span data-line="5"><span class="p">)</span>
</span></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Key Management Best Practices:</strong></p>
<ul class="simple">
<li><p>Store keys in environment variables, not in code</p></li>
<li><p>Rotate keys periodically using the key rotation feature</p></li>
<li><p>Lost keys = permanently encrypted data</p></li>
<li><p>Use cloud secret managers (AWS Secrets Manager, GCP Secret Manager) in production</p></li>
<li><p>See <a class="reference internal" href="deployment-security.html"><span class="doc">Deployment Security &amp; Reverse Proxy Configuration</span></a> for production encryption and secrets management guidance</p></li>
</ul>
</div>
</section>
<section id="key-rotation">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Key Rotation</a><a class="headerlink" href="#key-rotation" title="Link to this heading">¶</a></h3>
<p>ProxyWhirl supports gradual key rotation using MultiFernet, allowing you to rotate encryption keys without downtime or data loss.</p>
<p><strong>How Key Rotation Works:</strong></p>
<ol class="arabic simple">
<li><p><strong>Current Key</strong>: New data is encrypted with <code class="docutils literal notranslate"><span class="pre">PROXYWHIRL_CACHE_ENCRYPTION_KEY</span></code></p></li>
<li><p><strong>Previous Key</strong>: Old data can be decrypted with <code class="docutils literal notranslate"><span class="pre">PROXYWHIRL_CACHE_KEY_PREVIOUS</span></code></p></li>
<li><p><strong>Automatic Fallback</strong>: MultiFernet tries current key first, then previous key</p></li>
</ol>
<p><strong>Performing Key Rotation:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.fernet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fernet</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache.crypto</span><span class="w"> </span><span class="kn">import</span> <span class="n">rotate_key</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Generate new key</span>
</span><span data-line="5"><span class="n">new_key</span> <span class="o">=</span> <span class="n">Fernet</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Rotate to new key (moves current to previous)</span>
</span><span data-line="8"><span class="n">rotate_key</span><span class="p">(</span><span class="n">new_key</span><span class="p">)</span>
</span><span data-line="9">
</span><span data-line="10"><span class="c1"># Verify rotation</span>
</span><span data-line="11"><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span data-line="12"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PROXYWHIRL_CACHE_ENCRYPTION_KEY&#39;</span><span class="p">][:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span data-line="13"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Previous: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PROXYWHIRL_CACHE_KEY_PREVIOUS&#39;</span><span class="p">][:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Manual Rotation via Environment Variables:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Step 1: Generate new key</span>
</span><span data-line="2"><span class="nv">NEW_KEY</span><span class="o">=</span><span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())&quot;</span><span class="k">)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Step 2: Move current key to previous</span>
</span><span data-line="5"><span class="nb">export</span><span class="w"> </span><span class="nv">PROXYWHIRL_CACHE_KEY_PREVIOUS</span><span class="o">=</span><span class="nv">$PROXYWHIRL_CACHE_ENCRYPTION_KEY</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Step 3: Set new key as current</span>
</span><span data-line="8"><span class="nb">export</span><span class="w"> </span><span class="nv">PROXYWHIRL_CACHE_ENCRYPTION_KEY</span><span class="o">=</span><span class="nv">$NEW_KEY</span>
</span></pre></div>
</div>
<p><strong>Key Rotation Workflow:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Before rotation: old key encrypts and decrypts</span>
</span><span data-line="2"><span class="n">old_encryptor</span> <span class="o">=</span> <span class="n">CredentialEncryptor</span><span class="p">()</span>
</span><span data-line="3"><span class="n">encrypted_old</span> <span class="o">=</span> <span class="n">old_encryptor</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;password&quot;</span><span class="p">))</span>
</span><span data-line="4">
</span><span data-line="5"><span class="c1"># Perform rotation</span>
</span><span data-line="6"><span class="n">rotate_key</span><span class="p">(</span><span class="n">Fernet</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span><span data-line="7">
</span><span data-line="8"><span class="c1"># After rotation: new encryptor can decrypt old data</span>
</span><span data-line="9"><span class="n">new_encryptor</span> <span class="o">=</span> <span class="n">CredentialEncryptor</span><span class="p">()</span>
</span><span data-line="10"><span class="n">decrypted_old</span> <span class="o">=</span> <span class="n">new_encryptor</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_old</span><span class="p">)</span>  <span class="c1"># Still works!</span>
</span><span data-line="11">
</span><span data-line="12"><span class="c1"># New data encrypted with new key</span>
</span><span data-line="13"><span class="n">encrypted_new</span> <span class="o">=</span> <span class="n">new_encryptor</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;new_password&quot;</span><span class="p">))</span>
</span></pre></div>
</div>
<p><strong>Re-encryption Strategy:</strong></p>
<p>After rotation, gradually re-encrypt old data to remove dependency on previous key:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">CacheManager</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">manager</span> <span class="o">=</span> <span class="n">CacheManager</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span data-line="4">
</span><span data-line="5"><span class="c1"># Iterate all cache entries</span>
</span><span data-line="6"><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">manager</span><span class="o">.</span><span class="n">list_all_keys</span><span class="p">():</span>  <span class="c1"># hypothetical method</span>
</span><span data-line="7">    <span class="n">entry</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span data-line="8">    <span class="k">if</span> <span class="n">entry</span><span class="p">:</span>
</span><span data-line="9">        <span class="c1"># Get triggers decryption with previous key</span>
</span><span data-line="10">        <span class="c1"># Put triggers re-encryption with current key</span>
</span><span data-line="11">        <span class="n">manager</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can have at most 2 keys active simultaneously (current + previous). For multiple-key scenarios, chain rotations over time.</p>
</div>
</section>
<section id="encryption-behavior">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Encryption Behavior</a><a class="headerlink" href="#encryption-behavior" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>L1 (Memory)</strong>: Credentials stored as <code class="docutils literal notranslate"><span class="pre">SecretStr</span></code> (not encrypted)</p></li>
<li><p><strong>L2 (Disk)</strong>: Credentials encrypted in JSONL shards (default) or as BLOB fields in <code class="docutils literal notranslate"><span class="pre">l2_cache.db</span></code> (SQLite backend), depending on <code class="docutils literal notranslate"><span class="pre">l2_backend</span></code> setting</p></li>
<li><p><strong>L3 (SQLite)</strong>: Credentials encrypted as BLOB fields in main database</p></li>
</ul>
<p><strong>Automatic Encryption/Decryption:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Put: encrypts credentials before writing to L2/L3</span>
</span><span data-line="2"><span class="n">entry</span> <span class="o">=</span> <span class="n">CacheEntry</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">proxy_url</span><span class="o">=</span><span class="s2">&quot;http://proxy.example.com:8080&quot;</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">username</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;myuser&quot;</span><span class="p">),</span>
</span><span data-line="6">    <span class="n">password</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;mypassword&quot;</span><span class="p">),</span>
</span><span data-line="7">    <span class="c1"># ... other fields ...</span>
</span><span data-line="8"><span class="p">)</span>
</span><span data-line="9"><span class="n">manager</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Get: decrypts credentials when reading from L2/L3</span>
</span><span data-line="12"><span class="n">retrieved</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;abc123&quot;</span><span class="p">)</span>
</span><span data-line="13"><span class="nb">print</span><span class="p">(</span><span class="n">retrieved</span><span class="o">.</span><span class="n">username</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">())</span>  <span class="c1"># &quot;myuser&quot;</span>
</span><span data-line="14"><span class="nb">print</span><span class="p">(</span><span class="n">retrieved</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">())</span>  <span class="c1"># &quot;mypassword&quot;</span>
</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">SecretStr</span></code> prevents accidental credential leakage in logs, JSON serialization, and repr() output. Always use <code class="docutils literal notranslate"><span class="pre">.get_secret_value()</span></code> to access the plaintext.</p>
</div>
</section>
</section>
<section id="ttl-and-expiration">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">TTL and Expiration</a><a class="headerlink" href="#ttl-and-expiration" title="Link to this heading">¶</a></h2>
<section id="ttl-configuration">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">TTL Configuration</a><a class="headerlink" href="#ttl-configuration" title="Link to this heading">¶</a></h3>
<p>Proxies have configurable time-to-live (TTL) with per-source overrides:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">default_ttl_seconds</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>  <span class="c1"># 1 hour default</span>
</span><span data-line="3">    <span class="n">per_source_ttl</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="4">        <span class="s2">&quot;premium&quot;</span><span class="p">:</span> <span class="mi">7200</span><span class="p">,</span>       <span class="c1"># 2 hours for premium sources</span>
</span><span data-line="5">        <span class="s2">&quot;free&quot;</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span>          <span class="c1"># 30 minutes for free sources</span>
</span><span data-line="6">        <span class="s2">&quot;custom&quot;</span><span class="p">:</span> <span class="mi">10800</span><span class="p">,</span>       <span class="c1"># 3 hours for custom sources</span>
</span><span data-line="7">    <span class="p">},</span>
</span><span data-line="8"><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="expiration-strategies">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Expiration Strategies</a><a class="headerlink" href="#expiration-strategies" title="Link to this heading">¶</a></h3>
<p>ProxyWhirl uses <strong>hybrid lazy + background cleanup</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Lazy Expiration</strong>: On every <code class="docutils literal notranslate"><span class="pre">get()</span></code> operation, checks <code class="docutils literal notranslate"><span class="pre">entry.is_expired</span></code> and deletes if expired</p></li>
<li><p><strong>Background Cleanup</strong>: Periodic scan of all tiers to bulk-remove expired entries (optional)</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Enable background cleanup</span>
</span><span data-line="2"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">enable_background_cleanup</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">cleanup_interval_seconds</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="c1"># runs every 60 seconds</span>
</span><span data-line="5"><span class="p">)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="n">manager</span> <span class="o">=</span> <span class="n">CacheManager</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span data-line="8"><span class="c1"># Background thread automatically starts</span>
</span></pre></div>
</div>
<p><strong>Bulk Cleanup Performance:</strong></p>
<ul class="simple">
<li><p><strong>L1 (Memory)</strong>: O(n) scan, filters expired entries</p></li>
<li><p><strong>L2 (SQLite)</strong>: O(1) with indexed DELETE query on <code class="docutils literal notranslate"><span class="pre">l2_cache.db</span></code></p></li>
<li><p><strong>L3 (SQLite)</strong>: O(1) with indexed DELETE query on main database</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1">-- L2/L3 cleanup (both use efficient indexed DELETE)</span>
</span><span data-line="2"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cache_entries</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">expires_at</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">?</span>
</span><span data-line="3"><span class="c1">-- or for L2:</span>
</span><span data-line="4"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">l2_cache</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">expires_at</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">?</span>
</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For write-heavy workloads, disable background cleanup and rely on lazy expiration to reduce I/O.</p>
</div>
</section>
</section>
<section id="health-invalidation">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Health Invalidation</a><a class="headerlink" href="#health-invalidation" title="Link to this heading">¶</a></h2>
<p>The cache integrates with the health monitoring system to automatically evict failing proxies. This works in tandem with the <a class="reference internal" href="retry-failover.html"><span class="doc">Retry &amp; Failover Guide</span></a> circuit breaker system.</p>
<section id="configuration">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Configuration</a><a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">health_check_invalidation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># enable auto-eviction</span>
</span><span data-line="3">    <span class="n">failure_threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>              <span class="c1"># evict after 3 consecutive failures</span>
</span><span data-line="4"><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="invalidation-workflow">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Invalidation Workflow</a><a class="headerlink" href="#invalidation-workflow" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Health check fails for a proxy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">invalidate_by_health(key)</span></code> increments <code class="docutils literal notranslate"><span class="pre">failure_count</span></code></p></li>
<li><p>Sets <code class="docutils literal notranslate"><span class="pre">health_status</span> <span class="pre">=</span> <span class="pre">UNHEALTHY</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">failure_count</span> <span class="pre">&gt;=</span> <span class="pre">failure_threshold</span></code>, evicts from all tiers</p></li>
<li><p>Updates <code class="docutils literal notranslate"><span class="pre">evictions_health</span></code> statistics</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Manual health invalidation</span>
</span><span data-line="2"><span class="n">manager</span><span class="o">.</span><span class="n">invalidate_by_health</span><span class="p">(</span><span class="s2">&quot;abc123&quot;</span><span class="p">)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># After 3 consecutive failures, the proxy is evicted</span>
</span><span data-line="5"><span class="c1"># and statistics.l1_stats.evictions_health += 1</span>
</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even if <code class="docutils literal notranslate"><span class="pre">health_check_invalidation=False</span></code>, failure counts are still tracked. This allows post-hoc analysis without automatic eviction.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Cache health invalidation integrates directly with the circuit breaker system. When a proxy’s circuit breaker opens (see <a class="reference internal" href="retry-failover.html"><span class="doc">Retry &amp; Failover Guide</span></a>), the cache can automatically evict it. This ensures stale or unhealthy proxies are removed from all cache tiers.</p>
</div>
</section>
</section>
<section id="migration-from-jsonl-l2-cache">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">Migration from JSONL L2 Cache</a><a class="headerlink" href="#migration-from-jsonl-l2-cache" title="Link to this heading">¶</a></h2>
<p>ProxyWhirl previously used JSONL files for L2 cache but has migrated to SQLite for better performance. The <code class="docutils literal notranslate"><span class="pre">DiskCacheTier</span></code> class provides a migration utility for existing JSONL cache data.</p>
<section id="migrating-legacy-jsonl-caches">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Migrating Legacy JSONL Caches</a><a class="headerlink" href="#migrating-legacy-jsonl-caches" title="Link to this heading">¶</a></h3>
<p>If you have existing <code class="docutils literal notranslate"><span class="pre">shard_*.jsonl</span></code> files from a previous version, migrate them to the new SQLite L2 cache:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">CacheConfig</span><span class="p">,</span> <span class="n">CacheManager</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache.tiers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiskCacheTier</span><span class="p">,</span> <span class="n">TierType</span>
</span><span data-line="4">
</span><span data-line="5"><span class="c1"># Initialize L2 tier</span>
</span><span data-line="6"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span><span class="n">l2_cache_dir</span><span class="o">=</span><span class="s2">&quot;.cache/proxies&quot;</span><span class="p">)</span>
</span><span data-line="7"><span class="n">tier</span> <span class="o">=</span> <span class="n">DiskCacheTier</span><span class="p">(</span>
</span><span data-line="8">    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">l2_config</span><span class="p">,</span>
</span><span data-line="9">    <span class="n">tier_type</span><span class="o">=</span><span class="n">TierType</span><span class="o">.</span><span class="n">L2_FILE</span><span class="p">,</span>
</span><span data-line="10">    <span class="n">cache_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">l2_cache_dir</span><span class="p">),</span>
</span><span data-line="11"><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Migrate from JSONL files in the same directory</span>
</span><span data-line="14"><span class="n">migrated</span> <span class="o">=</span> <span class="n">tier</span><span class="o">.</span><span class="n">migrate_from_jsonl</span><span class="p">()</span>
</span><span data-line="15"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Migrated </span><span class="si">{</span><span class="n">migrated</span><span class="si">}</span><span class="s2"> entries from JSONL to SQLite L2 cache&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>The migration:</p>
<ul class="simple">
<li><p>Reads all <code class="docutils literal notranslate"><span class="pre">shard_*.jsonl</span></code> files in the cache directory</p></li>
<li><p>Decrypts credentials (if encrypted in JSONL)</p></li>
<li><p>Imports entries into the SQLite <code class="docutils literal notranslate"><span class="pre">l2_cache.db</span></code> database</p></li>
<li><p>Preserves all metadata (TTL, health status, access counts)</p></li>
<li><p>Skips corrupted entries and continues</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>After successful migration, delete the old <code class="docutils literal notranslate"><span class="pre">shard_*.jsonl</span></code> files to free up disk space.</p>
</div>
</section>
</section>
<section id="cache-warming">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Cache Warming</a><a class="headerlink" href="#cache-warming" title="Link to this heading">¶</a></h2>
<p>Pre-populate the cache from external proxy lists for faster startup.</p>
<section id="supported-formats">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Supported Formats</a><a class="headerlink" href="#supported-formats" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>JSON</strong>: Array of proxy objects</p></li>
<li><p><strong>JSONL</strong>: Newline-delimited JSON objects</p></li>
<li><p><strong>CSV</strong>: Header-based with <code class="docutils literal notranslate"><span class="pre">proxy_url</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code> columns</p></li>
</ul>
</section>
<section id="warming-from-file">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Warming from File</a><a class="headerlink" href="#warming-from-file" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Warm cache from JSONL file</span>
</span><span data-line="2"><span class="n">result</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">warm_from_file</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;proxies.jsonl&quot;</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">ttl_override</span><span class="o">=</span><span class="mi">7200</span><span class="p">,</span>  <span class="c1"># optional: override default TTL</span>
</span><span data-line="5"><span class="p">)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;loaded&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="8"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipped: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;skipped&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="9"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;failed&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Example JSONL format:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="p">{</span><span class="nt">&quot;proxy_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://proxy1.example.com:8080&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;warmed&quot;</span><span class="p">}</span>
</span><span data-line="2"><span class="p">{</span><span class="nt">&quot;proxy_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://user:pass@proxy2.example.com:8080&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;warmed&quot;</span><span class="p">}</span>
</span><span data-line="3"><span class="p">{</span><span class="nt">&quot;proxy_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://proxy3.example.com:8080&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pass&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;warmed&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
<p><strong>Example CSV format:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span data-line="1">proxy_url,username,password,source
</span><span data-line="2">http://proxy1.example.com:8080,,,warmed
</span><span data-line="3">http://proxy2.example.com:8080,user,pass,warmed
</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">warm_from_file()</span></code> with large proxy lists to bypass slow fetch operations during application startup.</p>
</div>
</section>
</section>
<section id="performance-tuning">
<h2><a class="toc-backref" href="#id25" role="doc-backlink">Performance Tuning</a><a class="headerlink" href="#performance-tuning" title="Link to this heading">¶</a></h2>
<section id="tier-sizing-recommendations">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Tier Sizing Recommendations</a><a class="headerlink" href="#tier-sizing-recommendations" title="Link to this heading">¶</a></h3>
<p><strong>Low-memory environments</strong> (serverless, containers):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">l1_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
</span><span data-line="3">    <span class="n">l2_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>  <span class="c1"># disable L2</span>
</span><span data-line="4">    <span class="n">l3_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
</span><span data-line="5"><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>High-throughput applications</strong> (web scrapers, load balancers):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">l1_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">10000</span><span class="p">),</span>
</span><span data-line="3">    <span class="n">l2_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">50000</span><span class="p">),</span>
</span><span data-line="4">    <span class="n">l3_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
</span><span data-line="5">    <span class="n">enable_background_cleanup</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="6"><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Read-heavy workloads</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">l1_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">5000</span><span class="p">),</span>  <span class="c1"># larger L1</span>
</span><span data-line="3">    <span class="n">l2_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>     <span class="c1"># skip L2</span>
</span><span data-line="4">    <span class="n">l3_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
</span><span data-line="5"><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="eviction-policy-selection">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Eviction Policy Selection</a><a class="headerlink" href="#eviction-policy-selection" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 15.0%" />
<col style="width: 25.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Policy</p></th>
<th class="head"><p>Best For</p></th>
<th class="head"><p>Pros</p></th>
<th class="head"><p>Cons</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lru</span></code></p></td>
<td><p>General-purpose, time-sensitive data</p></td>
<td><p>Simple, fast, predictable</p></td>
<td><p>Ignores frequency</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lfu</span></code></p></td>
<td><p>Frequently-accessed data</p></td>
<td><p>Optimizes for hot entries</p></td>
<td><p>Requires frequency tracking</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fifo</span></code></p></td>
<td><p>Sequential access patterns</p></td>
<td><p>Zero overhead</p></td>
<td><p>No recency/frequency awareness</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For most use cases, <strong>LRU</strong> (Least Recently Used) provides the best balance of simplicity and performance.</p>
</div>
</section>
<section id="performance-characteristics">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Performance Characteristics</a><a class="headerlink" href="#performance-characteristics" title="Link to this heading">¶</a></h3>
<p><strong>Operation Latencies</strong> (approximate):</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>L1</p></th>
<th class="head"><p>L2</p></th>
<th class="head"><p>L3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get()</span></code></p></td>
<td><p>~100 ns</p></td>
<td><p>~1-10 ms</p></td>
<td><p>~5-50 ms</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">put()</span></code></p></td>
<td><p>~200 ns</p></td>
<td><p>~2-20 ms</p></td>
<td><p>~10-100 ms</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delete()</span></code></p></td>
<td><p>~100 ns</p></td>
<td><p>~2-10 ms</p></td>
<td><p>~5-50 ms</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cleanup_expired()</span></code></p></td>
<td><p>~1 µs/entry</p></td>
<td><p>~1 µs (SQL DELETE)</p></td>
<td><p>~1 µs (SQL DELETE)</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Memory Usage</strong> (approximate):</p>
<ul class="simple">
<li><p><strong>L1</strong>: ~500 bytes per entry (Python object overhead)</p></li>
<li><p><strong>L2</strong>: ~400 bytes per entry (JSONL or SQLite, depending on <code class="docutils literal notranslate"><span class="pre">l2_backend</span></code>)</p></li>
<li><p><strong>L3</strong>: ~450 bytes per entry (SQLite storage with health fields)</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Large L1 caches (&gt;10,000 entries) may trigger Python garbage collection pauses. Monitor GC stats with <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">gc;</span> <span class="pre">gc.get_stats()</span></code>.</p>
</div>
</section>
<section id="graceful-degradation">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Graceful Degradation</a><a class="headerlink" href="#graceful-degradation" title="Link to this heading">¶</a></h3>
<p>If a tier fails repeatedly (e.g., disk full, database locked), it auto-disables after 3 consecutive failures:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># L2 disk full → tier disabled</span>
</span><span data-line="2"><span class="n">manager</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
</span><span data-line="3"><span class="c1"># L1 and L3 still work</span>
</span><span data-line="4">
</span><span data-line="5"><span class="n">stats</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span>
</span><span data-line="6"><span class="k">if</span> <span class="n">stats</span><span class="o">.</span><span class="n">l2_degraded</span><span class="p">:</span>
</span><span data-line="7">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: L2 tier degraded, running on L1+L3 only&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Tiers automatically re-enable after a successful operation.</p>
</section>
</section>
<section id="cli-integration">
<h2><a class="toc-backref" href="#id30" role="doc-backlink">CLI Integration</a><a class="headerlink" href="#cli-integration" title="Link to this heading">¶</a></h2>
<p>The CLI exposes cache configuration via TOML config file. See <a class="reference internal" href="cli-reference.html"><span class="doc">CLI Reference</span></a> for full CLI command documentation and <a class="reference internal" href="../reference/configuration.html"><span class="doc">Configuration Reference</span></a> for all configuration keys.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># ~/.config/proxywhirl/config.toml</span>
</span><span data-line="2"><span class="n">cache_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span data-line="3"><span class="n">cache_l1_max_entries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
</span><span data-line="4"><span class="n">cache_l2_max_entries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5000</span>
</span><span data-line="5"><span class="n">cache_l3_max_entries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1"># 0 = unlimited</span>
</span><span data-line="6"><span class="n">cache_default_ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3600</span>
</span><span data-line="7"><span class="n">cache_cleanup_interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span>
</span><span data-line="8"><span class="n">cache_l2_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.cache/proxies&quot;</span>
</span><span data-line="9"><span class="n">cache_l3_db_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.cache/db/proxywhirl.db&quot;</span>
</span><span data-line="10"><span class="n">cache_encryption_key_env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;PROXYWHIRL_CACHE_ENCRYPTION_KEY&quot;</span>
</span><span data-line="11"><span class="n">cache_health_invalidation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span data-line="12"><span class="n">cache_failure_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
</span></pre></div>
</div>
</section>
<section id="best-practices">
<h2><a class="toc-backref" href="#id31" role="doc-backlink">Best Practices</a><a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<section id="security">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Security</a><a class="headerlink" href="#security" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Always encrypt credentials</strong>: Set <code class="docutils literal notranslate"><span class="pre">PROXYWHIRL_CACHE_ENCRYPTION_KEY</span></code> in production</p></li>
<li><p><strong>Rotate encryption keys</strong>: Re-encrypt cache data periodically</p></li>
<li><p><strong>Restrict file permissions</strong>: L2 cache directory should be mode 0700 (owner-only)</p></li>
<li><p><strong>Use SecretStr</strong>: Never log or serialize credentials directly</p></li>
</ol>
</section>
<section id="performance">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">Performance</a><a class="headerlink" href="#performance" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Size L1 appropriately</strong>: Too large → GC pauses, too small → excessive L2/L3 access</p></li>
<li><p><strong>Enable background cleanup</strong>: For write-heavy workloads with short TTLs</p></li>
<li><p><strong>Disable unused tiers</strong>: If you don’t need L2, disable it to reduce I/O</p></li>
<li><p><strong>Monitor hit rates</strong>: Aim for &gt;80% overall hit rate</p></li>
</ol>
</section>
<section id="reliability">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Reliability</a><a class="headerlink" href="#reliability" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Handle degraded tiers</strong>: Check <code class="docutils literal notranslate"><span class="pre">CacheStatistics.l{1,2,3}_degraded</span></code> in metrics</p></li>
<li><p><strong>Monitor eviction reasons</strong>: High <code class="docutils literal notranslate"><span class="pre">evictions_health</span></code> → upstream proxy issues</p></li>
<li><p><strong>Test encryption key recovery</strong>: Ensure you can restore from backups</p></li>
<li><p><strong>Use per-source TTLs</strong>: Premium sources can have longer TTLs</p></li>
</ol>
</section>
</section>
<section id="example-complete-cache-setup">
<h2><a class="toc-backref" href="#id35" role="doc-backlink">Example: Complete Cache Setup</a><a class="headerlink" href="#example-complete-cache-setup" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">CacheManager</span><span class="p">,</span> <span class="n">CacheConfig</span><span class="p">,</span> <span class="n">CacheTierConfig</span><span class="p">,</span> <span class="n">CacheEntry</span><span class="p">,</span> <span class="n">HealthStatus</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">SecretStr</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span><span class="p">,</span> <span class="n">timedelta</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># 1. Configure cache</span>
</span><span data-line="7"><span class="n">config</span> <span class="o">=</span> <span class="n">CacheConfig</span><span class="p">(</span>
</span><span data-line="8">    <span class="c1"># Tier configuration</span>
</span><span data-line="9">    <span class="n">l1_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="s2">&quot;lru&quot;</span><span class="p">),</span>
</span><span data-line="10">    <span class="n">l2_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="s2">&quot;lru&quot;</span><span class="p">),</span>
</span><span data-line="11">    <span class="n">l3_config</span><span class="o">=</span><span class="n">CacheTierConfig</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="s2">&quot;lru&quot;</span><span class="p">),</span>
</span><span data-line="12">
</span><span data-line="13">    <span class="c1"># TTL configuration</span>
</span><span data-line="14">    <span class="n">default_ttl_seconds</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
</span><span data-line="15">    <span class="n">enable_background_cleanup</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">cleanup_interval_seconds</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">per_source_ttl</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="18">        <span class="s2">&quot;premium&quot;</span><span class="p">:</span> <span class="mi">7200</span><span class="p">,</span>
</span><span data-line="19">        <span class="s2">&quot;free&quot;</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span>
</span><span data-line="20">    <span class="p">},</span>
</span><span data-line="21">
</span><span data-line="22">    <span class="c1"># Storage paths</span>
</span><span data-line="23">    <span class="n">l2_cache_dir</span><span class="o">=</span><span class="s2">&quot;.cache/proxies&quot;</span><span class="p">,</span>           <span class="c1"># L2 SQLite: .cache/proxies/l2_cache.db</span>
</span><span data-line="24">    <span class="n">l3_database_path</span><span class="o">=</span><span class="s2">&quot;.cache/db/proxywhirl.db&quot;</span><span class="p">,</span>  <span class="c1"># L3 SQLite main database</span>
</span><span data-line="25">
</span><span data-line="26">    <span class="c1"># Encryption</span>
</span><span data-line="27">    <span class="n">encryption_key</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PROXYWHIRL_CACHE_ENCRYPTION_KEY&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
</span><span data-line="28">
</span><span data-line="29">    <span class="c1"># Health integration</span>
</span><span data-line="30">    <span class="n">health_check_invalidation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="31">    <span class="n">failure_threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span data-line="32"><span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34"><span class="c1"># 2. Initialize manager</span>
</span><span data-line="35"><span class="n">manager</span> <span class="o">=</span> <span class="n">CacheManager</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span data-line="36">
</span><span data-line="37"><span class="c1"># 3. Warm cache from file</span>
</span><span data-line="38"><span class="n">result</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">warm_from_file</span><span class="p">(</span><span class="s2">&quot;proxies.jsonl&quot;</span><span class="p">,</span> <span class="n">ttl_override</span><span class="o">=</span><span class="mi">7200</span><span class="p">)</span>
</span><span data-line="39"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warmed cache: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;loaded&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> entries&quot;</span><span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41"><span class="c1"># 4. Add new proxy</span>
</span><span data-line="42"><span class="n">entry</span> <span class="o">=</span> <span class="n">CacheEntry</span><span class="p">(</span>
</span><span data-line="43">    <span class="n">key</span><span class="o">=</span><span class="n">CacheManager</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s2">&quot;http://proxy.example.com:8080&quot;</span><span class="p">),</span>
</span><span data-line="44">    <span class="n">proxy_url</span><span class="o">=</span><span class="s2">&quot;http://proxy.example.com:8080&quot;</span><span class="p">,</span>
</span><span data-line="45">    <span class="n">username</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">),</span>
</span><span data-line="46">    <span class="n">password</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;pass&quot;</span><span class="p">),</span>
</span><span data-line="47">    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;premium&quot;</span><span class="p">,</span>
</span><span data-line="48">    <span class="n">fetch_time</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
</span><span data-line="49">    <span class="n">ttl_seconds</span><span class="o">=</span><span class="mi">7200</span><span class="p">,</span>  <span class="c1"># 2 hours</span>
</span><span data-line="50">    <span class="n">expires_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
</span><span data-line="51">    <span class="n">health_status</span><span class="o">=</span><span class="n">HealthStatus</span><span class="o">.</span><span class="n">HEALTHY</span><span class="p">,</span>
</span><span data-line="52">    <span class="n">access_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span data-line="53">    <span class="n">last_accessed</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
</span><span data-line="54"><span class="p">)</span>
</span><span data-line="55"><span class="n">manager</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
</span><span data-line="56">
</span><span data-line="57"><span class="c1"># 5. Retrieve proxy (with tier promotion)</span>
</span><span data-line="58"><span class="n">retrieved</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</span><span data-line="59"><span class="k">if</span> <span class="n">retrieved</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">retrieved</span><span class="o">.</span><span class="n">is_expired</span><span class="p">:</span>
</span><span data-line="60">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieved proxy: </span><span class="si">{</span><span class="n">retrieved</span><span class="o">.</span><span class="n">proxy_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="61">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Access count: </span><span class="si">{</span><span class="n">retrieved</span><span class="o">.</span><span class="n">access_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="62">
</span><span data-line="63"><span class="c1"># 6. Invalidate unhealthy proxy</span>
</span><span data-line="64"><span class="n">manager</span><span class="o">.</span><span class="n">invalidate_by_health</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</span><span data-line="65">
</span><span data-line="66"><span class="c1"># 7. Monitor statistics</span>
</span><span data-line="67"><span class="n">stats</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span>
</span><span data-line="68"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall hit rate: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">overall_hit_rate</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="69"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total size: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">total_size</span><span class="si">}</span><span class="s2"> entries&quot;</span><span class="p">)</span>
</span><span data-line="70"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Promotions: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">promotions</span><span class="si">}</span><span class="s2">, Demotions: </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">demotions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="71">
</span><span data-line="72"><span class="c1"># 8. Export metrics</span>
</span><span data-line="73"><span class="n">metrics</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">to_metrics_dict</span><span class="p">()</span>
</span><span data-line="74"><span class="c1"># Send to monitoring system (Prometheus, Datadog, etc.)</span>
</span></pre></div>
</div>
</section>
<section id="troubleshooting">
<h2><a class="toc-backref" href="#id36" role="doc-backlink">Troubleshooting</a><a class="headerlink" href="#troubleshooting" title="Link to this heading">¶</a></h2>
<section id="low-hit-rates">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">Low Hit Rates</a><a class="headerlink" href="#low-hit-rates" title="Link to this heading">¶</a></h3>
<p><strong>Symptom</strong>: <code class="docutils literal notranslate"><span class="pre">overall_hit_rate</span> <span class="pre">&lt;</span> <span class="pre">0.5</span></code></p>
<p><strong>Solutions</strong>:</p>
<ul class="simple">
<li><p>Increase L1 capacity</p></li>
<li><p>Increase TTL for stable sources</p></li>
<li><p>Enable background cleanup to prevent expired entries from polluting cache</p></li>
<li><p>Warm cache at startup</p></li>
</ul>
</section>
<section id="high-memory-usage">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">High Memory Usage</a><a class="headerlink" href="#high-memory-usage" title="Link to this heading">¶</a></h3>
<p><strong>Symptom</strong>: Python process RSS &gt; expected</p>
<p><strong>Solutions</strong>:</p>
<ul class="simple">
<li><p>Reduce L1 <code class="docutils literal notranslate"><span class="pre">max_entries</span></code></p></li>
<li><p>Disable L2 tier and rely on L1+L3 only</p></li>
<li><p>Monitor with <code class="docutils literal notranslate"><span class="pre">gc.get_stats()</span></code> and adjust eviction policy</p></li>
</ul>
</section>
<section id="encryption-errors">
<h3><a class="toc-backref" href="#id39" role="doc-backlink">Encryption Errors</a><a class="headerlink" href="#encryption-errors" title="Link to this heading">¶</a></h3>
<p><strong>Symptom</strong>: <code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">Decryption</span> <span class="pre">failed</span></code></p>
<p><strong>Solutions</strong>:</p>
<ul class="simple">
<li><p>Verify <code class="docutils literal notranslate"><span class="pre">PROXYWHIRL_CACHE_ENCRYPTION_KEY</span></code> is set correctly</p></li>
<li><p>Check if encryption key changed (requires cache clear)</p></li>
<li><p>Inspect L2/L3 files for corruption</p></li>
</ul>
</section>
<section id="tier-degradation">
<h3><a class="toc-backref" href="#id40" role="doc-backlink">Tier Degradation</a><a class="headerlink" href="#tier-degradation" title="Link to this heading">¶</a></h3>
<p><strong>Symptom</strong>: <code class="docutils literal notranslate"><span class="pre">l2_degraded=True</span></code> or <code class="docutils literal notranslate"><span class="pre">l3_degraded=True</span></code></p>
<p><strong>Solutions</strong>:</p>
<ul class="simple">
<li><p>Check disk space for L2 cache directory</p></li>
<li><p>Check file permissions (should be 0700)</p></li>
<li><p>Verify SQLite database is not locked by another process</p></li>
<li><p>Review logs for tier-specific errors</p></li>
</ul>
</section>
</section>
<section id="see-also">
<h2><a class="toc-backref" href="#id41" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h2>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 sd-g-3 sd-g-xs-3 sd-g-sm-3 sd-g-md-3 sd-g-lg-3 docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Cache API Reference</div>
<p class="sd-card-text">Complete API docs for <code class="docutils literal notranslate"><span class="pre">CacheManager</span></code>, <code class="docutils literal notranslate"><span class="pre">CacheEntry</span></code>, <code class="docutils literal notranslate"><span class="pre">CacheConfig</span></code>, and <code class="docutils literal notranslate"><span class="pre">CacheStatistics</span></code>.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../reference/cache-api.html"><span class="doc">Cache API Reference</span></a></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Configuration Reference</div>
<p class="sd-card-text">Full configuration reference including cache-related TOML keys and environment variables.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../reference/configuration.html"><span class="doc">Configuration Reference</span></a></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
CLI Reference</div>
<p class="sd-card-text">CLI commands for cache configuration, proxy fetching, and data export.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="cli-reference.html"><span class="doc">CLI Reference</span></a></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Deployment Security</div>
<p class="sd-card-text">Production deployment with encryption, reverse proxy setup, and security hardening.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="deployment-security.html"><span class="doc">Deployment Security &amp; Reverse Proxy Configuration</span></a></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Automation Guide</div>
<p class="sd-card-text">CI/CD integration for automated cache warming and proxy refresh.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="automation.html"><span class="doc">Automation &amp; CI/CD Runbook</span></a></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Getting Started</div>
<p class="sd-card-text">Quickstart guide for basic ProxyWhirl usage.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../getting-started/index.html"><span class="doc">Getting Started</span></a></div>
</div>
</div>
</div>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="advanced-strategies.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">Advanced Rotation Strategies</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="retry-failover.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">Retry &amp; Failover Guide</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2026, Wyatt Walsh</p>
  
  <p>
    Made with
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials">
<a href="https://github.com/wyattowalsh/proxywhirl" aria-label="GitHub">
  <iconify-icon icon="simple-icons:github"></iconify-icon>
</a></div>
    </div>
  </div>
</footer>
      <script src="../_static/documentation_options.js?v=a58bc63e"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../_static/shibuya.js?v=cac61aee"></script></body>
</html>