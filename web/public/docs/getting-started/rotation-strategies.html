<!DOCTYPE html>
<html lang="en" data-accent-color="violet" data-content_root="../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Rotation Strategies - ProxyWhirl Documentation</title><link rel="shortcut icon" href="../_static/favicon.svg"/><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Guides" href="../guides/index.html" /><link rel="prev" title="Getting Started" href="index.html" />
      <link rel="canonical" href="https://www.proxywhirl.com/docs/getting-started/rotation-strategies.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=e1a1ceaf" />
    <link rel="stylesheet" type="text/css" href="../_static/shibuya.css?v=44020203" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link media="print" rel="stylesheet" type="text/css" href="../_static/print.css?v=20ff2c19" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b31b09b0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://www.proxywhirl.com/docs/getting-started/rotation-strategies.html"/>
  <meta property="og:title" content="Rotation Strategies"/>
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:creator" content="@wyaborern"/>
<meta name="twitter:site" content="@wyaborern"/>
  </head>
<body>
<a class="skip-link" href="#main-content">Skip to content</a>
<header class="pw-navbar">
  <div class="pw-navbar-inner">
    
    <button class="pw-navbar-sidebar-toggle js-menu" aria-controls="lside" aria-expanded="false" aria-label="Toggle navigation" type="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
    </button>

    
    <a href="../index.html" class="pw-navbar-brand">
      <svg class="pw-navbar-logo" viewBox="0 0 100 100" aria-hidden="true">
        <defs>
          <linearGradient id="pw-logo-grad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#06b6d4"/>
            <stop offset="50%" stop-color="#3b82f6"/>
            <stop offset="100%" stop-color="#8b5cf6"/>
          </linearGradient>
        </defs>
        <circle cx="50" cy="50" r="44" fill="none" stroke="url(#pw-logo-grad)" stroke-width="6" stroke-linecap="round" stroke-dasharray="60 30"/>
        <g fill="url(#pw-logo-grad)">
          <path d="M50 18 L58 30 L52 30 L52 42 L48 42 L48 30 L42 30 Z"/>
          <path d="M82 50 L70 58 L70 52 L58 52 L58 48 L70 48 L70 42 Z"/>
          <path d="M50 82 L42 70 L48 70 L48 58 L52 58 L52 70 L58 70 Z"/>
          <path d="M18 50 L30 42 L30 48 L42 48 L42 52 L30 52 L30 58 Z"/>
        </g>
        <circle cx="50" cy="50" r="8" fill="url(#pw-logo-grad)"/>
      </svg>
      <strong>ProxyWhirl</strong>
    </a>

    
    <nav class="pw-navbar-links" aria-label="Main navigation">
      <a href="index.html" class="pw-navbar-link" data-section="getting-started">
        Getting Started
      </a>
      <a href="../guides/index.html" class="pw-navbar-link" data-section="guides">
        Guides
      </a>
      <a href="../reference/index.html" class="pw-navbar-link" data-section="reference">
        Reference
      </a>
      <a href="../project/index.html" class="pw-navbar-link" data-section="project">
        Project
      </a>
    </nav>

    
    <div class="pw-navbar-actions">
      
      <button class="pw-navbar-btn" id="pw-theme-toggle" type="button" aria-label="Toggle theme" aria-pressed="false">
        <svg class="pw-icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
        <svg class="pw-icon-moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
      </button>

      
      <a href="https://github.com/wyattowalsh/proxywhirl" class="pw-navbar-btn pw-navbar-github" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
      </a>
    </div>
  </div>
</header>
<div id="main-content"></div>

<script>
(function() {
  /* Theme toggle */
  var toggle = document.getElementById('pw-theme-toggle');
  if (toggle) {
    /* Set initial aria-pressed based on current theme */
    var currentlyDark = document.documentElement.classList.contains('dark');
    toggle.setAttribute('aria-pressed', currentlyDark ? 'true' : 'false');

    toggle.addEventListener('click', function() {
      var isDark = document.documentElement.classList.contains('dark');
      var next = isDark ? 'light' : 'dark';
      localStorage._theme = next;
      if (typeof setColorMode === 'function') {
        setColorMode(next);
      } else {
        var html = document.documentElement;
        html.classList.remove('dark', 'light');
        html.classList.add(next);
        html.setAttribute('data-color-mode', next);
      }
      toggle.setAttribute('aria-pressed', next === 'dark' ? 'true' : 'false');
    });
  }

  /* Active nav link detection — highlight current section */
  var path = window.location.pathname;
  var links = document.querySelectorAll('.pw-navbar-link[data-section]');
  links.forEach(function(link) {
    var section = link.getAttribute('data-section');
    if (path.indexOf('/' + section) !== -1) {
      link.classList.add('active');
    }
  });
  /* Mark home page — none active, or all inactive is fine */
})();
</script>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="2"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started</a><ul class="current">
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#what-youll-build">What You&#8217;ll Build</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#quick-start">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#basic-usage-sync">Basic Usage (sync)</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#async-usage">Async Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#context-manager-pattern">Context Manager Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#authenticated-proxies">Authenticated Proxies</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#using-free-proxy-lists">Using Free Proxy Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#fetching-proxies-programmatically">Fetching Proxies Programmatically</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#choosing-a-rotation-strategy">Choosing a Rotation Strategy</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#configuring-retry-and-circuit-breakers">Configuring Retry and Circuit Breakers</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#monitoring-your-pool">Monitoring Your Pool</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="index.html#next-steps">Next Steps</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#for-contributors">For Contributors</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Rotation Strategies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bootstrap-a-rotator">Bootstrap a Rotator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#decision-matrix">Decision Matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quick-pick-guide">Quick-Pick Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="#strategy-reference">Strategy Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="#comparison-at-a-glance">Comparison At a Glance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hot-swapping-strategies">Hot-Swapping Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#observe-the-pool">Observe the Pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-a-custom-strategy">Building a Custom Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 _expand"><a class="reference internal" href="../guides/index.html">Guides</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../guides/index.html#choosing-a-guide">Choosing a Guide</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../guides/index.html#client-concurrency">Client &amp; Concurrency</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../guides/index.html#resilience-caching">Resilience &amp; Caching</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../guides/index.html#operations-deployment">Operations &amp; Deployment</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../guides/index.html#automation-ai">Automation &amp; AI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guides/async-client.html">Async Client Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#when-to-use-async-vs-sync">When to Use Async vs Sync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#context-manager-usage">Context Manager Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#http-request-methods">HTTP Request Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#proxy-management">Proxy Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#hot-swapping-strategies">Hot-Swapping Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#concurrent-requests-with-asyncio-gather">Concurrent Requests with asyncio.gather</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#asyncio-integration-patterns">Asyncio Integration Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#comparison-async-vs-sync">Comparison: Async vs Sync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#best-practices-and-common-patterns">Best Practices and Common Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/async-client.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guides/advanced-strategies.html">Advanced Rotation Strategies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#performance-based-strategy">Performance-Based Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#session-persistence-strategy">Session Persistence Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#geo-targeted-strategy">Geo-Targeted Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#cost-aware-strategy">Cost-Aware Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#composite-strategy">Composite Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#strategy-registry">Strategy Registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#selectioncontext">SelectionContext</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#strategyconfig">StrategyConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#custom-strategy-implementation">Custom Strategy Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#strategyregistry-usage">StrategyRegistry Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#id16">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#testing-strategies">Testing Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#performance-benchmarks">Performance Benchmarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/advanced-strategies.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guides/caching.html">Caching Subsystem Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#core-components">Core Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#credential-encryption">Credential Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#ttl-and-expiration">TTL and Expiration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#health-invalidation">Health Invalidation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#migration-from-jsonl-l2-cache">Migration from JSONL L2 Cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#cache-warming">Cache Warming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#performance-tuning">Performance Tuning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#cli-integration">CLI Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#example-complete-cache-setup">Example: Complete Cache Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/caching.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guides/retry-failover.html">Retry &amp; Failover Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#when-to-use-retry-vs-failover">When to Use Retry vs Failover</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#retrypolicy-configuration">RetryPolicy Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#circuit-breaker-configuration">Circuit Breaker Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#intelligent-proxy-selection">Intelligent Proxy Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#retrymetrics-and-observability">RetryMetrics and Observability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#retryexecutor-deep-dive">RetryExecutor Deep Dive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#integration-with-proxywhirl">Integration with ProxyWhirl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#advanced-patterns">Advanced Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#performance-impact">Performance Impact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#see-also">See Also</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/retry-failover.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guides/deployment-security.html">Deployment Security &amp; Reverse Proxy Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guides/deployment-security.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/deployment-security.html#x-forwarded-for-security">X-Forwarded-For Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/deployment-security.html#reverse-proxy-configurations">Reverse Proxy Configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/deployment-security.html#proxywhirl-configuration">ProxyWhirl Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/deployment-security.html#security-checklist">Security Checklist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/deployment-security.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/deployment-security.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guides/cli-reference.html">CLI Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#global-options">Global Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#commands">Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#output-formats">Output Formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#configuration-file">Configuration File</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#advanced-usage">Advanced Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#exit-codes">Exit Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/cli-reference.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guides/automation.html">Automation &amp; CI/CD Runbook</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#pre-flight-checks">Pre-flight Checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#github-actions-ci-pipeline">GitHub Actions CI Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#cron-based-proxy-fetching">Cron-Based Proxy Fetching</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#docker-deployment">Docker Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#integration-testing-patterns">Integration Testing Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#smoke-tests-for-docs-examples">Smoke Tests for Docs Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#automating-releases">Automating Releases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#docsearch-credentials">DocSearch Credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#ci-stage-summary">CI Stage Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/automation.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guides/mcp-server.html">MCP Server Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#quick-start">Quick Start</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#the-proxywhirl-tool">The <code class="docutils literal notranslate"><span class="pre">proxywhirl</span></code> Tool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#prompts">Prompts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#authentication">Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#progress-reporting">Progress Reporting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#transport-options">Transport Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#integration-with-claude-desktop">Integration with Claude Desktop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#programmatic-usage">Programmatic Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#lifecycle-management">Lifecycle Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guides/mcp-server.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 _expand"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/index.html#quick-lookup">Quick Lookup</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/index.html#api-surfaces">API Surfaces</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/index.html#configuration-error-handling">Configuration &amp; Error Handling</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../reference/index.html#subsystem-apis">Subsystem APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/rest-api.html">ProxyWhirl REST API Usage Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#authentication">Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#middleware">Middleware</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#endpoint-reference">Endpoint Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#rate-limiting">Rate Limiting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#performance-tips">Performance Tips</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#security-best-practices">Security Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#deployment-examples">Deployment Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#x-forwarded-for-security-checklist">X-Forwarded-For Security Checklist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#security-references">Security References</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#see-also">See Also</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rest-api.html#support">Support</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/python-api.html">Python API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#core-classes">Core Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#rotation-strategies">Rotation Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#data-models">Data Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#cache-components">Cache Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#retry-failover">Retry &amp; Failover</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#parsers">Parsers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#enumerations">Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#built-in-proxy-sources">Built-in Proxy Sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#exceptions">Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#type-annotations">Type Annotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#version">Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/python-api.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/configuration.html">Configuration Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#configuration-discovery">Configuration Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#toml-configuration-format">TOML Configuration Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#configuration-classes">Configuration Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#programmatic-configuration">Programmatic Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#validation-rules">Validation Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#security-best-practices">Security Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#configuration-examples">Configuration Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#migration-from-legacy-config">Migration from Legacy Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/configuration.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/exceptions.html">Exceptions Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#exception-hierarchy">Exception Hierarchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#proxyerrorcode-enum">ProxyErrorCode Enum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#error-codes">Error Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#exception-reference">Exception Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#error-handling-patterns">Error Handling Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/exceptions.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cache-api.html">Cache API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#data-models">Data Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#tier-implementations">Tier Implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#utilities">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/cache-api.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/rate-limiting-api.html">Rate Limiting API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#core-classes">Core Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#data-models">Data Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#integration-with-monitoring">Integration with Monitoring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#sphinx-integration">Sphinx Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#common-patterns">Common Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#faq">FAQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/rate-limiting-api.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 _expand"><a class="reference internal" href="../project/index.html">Project</a><ul>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#development-setup">Development Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#clone-install">Clone &amp; Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#verify-installation">Verify Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#make-commands">Make Commands</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#contributing">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#workflow">Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#branch-naming">Branch Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#commit-convention">Commit Convention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#code-style">Code Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#pre-commit-hooks">Pre-commit Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#testing-guidelines">Testing Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#extending-with-custom-strategies">Extending with Custom Strategies</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#ci-cd-pipelines">CI/CD Pipelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#quality-gate-pipeline">Quality Gate Pipeline</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#architecture">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#module-map">Module Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#key-exports">Key Exports</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#current-health">Current Health</a></li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#changelog-highlights">Changelog Highlights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#recent">Recent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/index.html#phase-completion-status">Phase Completion Status</a></li>
</ul>
</li>
<li class="toctree-l2 _expand"><a class="reference internal" href="../project/index.html#license">License</a></li>
</ul>
</li>
</ul>
        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3><ul>
<li><a class="reference internal" href="#bootstrap-a-rotator">Bootstrap a Rotator</a></li>
<li><a class="reference internal" href="#decision-matrix">Decision Matrix</a></li>
<li><a class="reference internal" href="#quick-pick-guide">Quick-Pick Guide</a></li>
<li><a class="reference internal" href="#strategy-reference">Strategy Reference</a><ul>
<li><a class="reference internal" href="#round-robin">1. Round-Robin</a></li>
<li><a class="reference internal" href="#random">2. Random</a></li>
<li><a class="reference internal" href="#weighted">3. Weighted</a></li>
<li><a class="reference internal" href="#least-used">4. Least-Used</a></li>
<li><a class="reference internal" href="#performance-based">5. Performance-Based</a></li>
<li><a class="reference internal" href="#session-persistence">6. Session Persistence</a></li>
<li><a class="reference internal" href="#geo-targeted">7. Geo-Targeted</a></li>
<li><a class="reference internal" href="#cost-aware">8. Cost-Aware</a></li>
<li><a class="reference internal" href="#composite">9. Composite</a></li>
</ul>
</li>
<li><a class="reference internal" href="#comparison-at-a-glance">Comparison At a Glance</a></li>
<li><a class="reference internal" href="#hot-swapping-strategies">Hot-Swapping Strategies</a></li>
<li><a class="reference internal" href="#observe-the-pool">Observe the Pool</a></li>
<li><a class="reference internal" href="#building-a-custom-strategy">Building a Custom Strategy</a></li>
<li><a class="reference internal" href="#further-reading">Further Reading</a></li>
</ul>
</div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">ProxyWhirl</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="index.html"><span itemprop="name">Getting Started</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">Rotation Strategies</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="relative min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
  <div class="copy-page-wrapper relative pb-4 lg:absolute lg:top-8 lg:right-6 xl:right-12">
  <div id="copy-page-trigger">
    <button
      type="button"
      class="js-copy px-3 py-1 inline-flex items-center gap-1"
      data-url="https://www.proxywhirl.com/docs/_sources/getting-started/rotation-strategies.md.txt"
    >
      <i class="i-lucide" data-icon="copy"></i>
      <span>Copy page</span>
    </button>
    <button class="js-menu px-2 py-1" type="button" aria-label="More actions"
      aria-haspopup="menu" aria-expanded="false" aria-controls="copy-page-content">
      <i class="i-lucide chevron-down"></i>
    </button>
  </div>
  <div id="copy-page-content" role="menu" aria-orientation="vertical" aria-hidden="true">
    <div role="presentation">
      <div class="flex flex-col" role="group">
        <button class="js-copy" type="button" role="menuitem"
          data-url="https://www.proxywhirl.com/docs/_sources/getting-started/rotation-strategies.md.txt">
          <span class="iconify-icon">
            <i class="i-lucide" data-icon="copy"></i>
          </span>
          <span>Copy page</span>
        </button>
        <a role="menuitem" href="https://www.proxywhirl.com/docs/_sources/getting-started/rotation-strategies.md.txt" target="_blank" rel="nofollow"><iconify-icon icon="bi:markdown"></iconify-icon>
            <span>View as Markdown</span></a><a role="menuitem" href="https://chatgpt.com/?hints=search&q=Read%20https%3A//www.proxywhirl.com/docs/_sources/getting-started/rotation-strategies.md.txt%20so%20I%20can%20ask%20questions%20about%20it." target="_blank" rel="nofollow">
          <iconify-icon icon="bi:openai"></iconify-icon>
          <span>Open in ChatGPT</span>
        </a><a role="menuitem" href="https://claude.ai/new?q=Read%20https%3A//www.proxywhirl.com/docs/_sources/getting-started/rotation-strategies.md.txt%20so%20I%20can%20ask%20questions%20about%20it." target="_blank" rel="nofollow">
          <iconify-icon icon="bi:claude"></iconify-icon>
          <span>Open in Claude</span>
        </a></div>
    </div>
  </div>
</div><article class="yue dark-code" role="main">
          <p>ProxyWhirl ships <strong>9 rotation strategies</strong> covering everything from simple round-robin to composite filter-then-select pipelines. This guide shows how to configure each one, when to use it, and how to build custom strategies.</p>
<section id="rotation-strategies">
<h1>Rotation Strategies<a class="headerlink" href="#rotation-strategies" title="Link to this heading">¶</a></h1>
<section id="bootstrap-a-rotator">
<h2>Bootstrap a Rotator<a class="headerlink" href="#bootstrap-a-rotator" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProxyWhirl</span><span class="p">,</span> <span class="n">Proxy</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">SecretStr</span>
</span><span data-line="3">
</span><span data-line="4"><span class="n">proxies</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="5">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://proxy1.example.com:8080&quot;</span><span class="p">),</span>
</span><span data-line="6">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://proxy2.example.com:8080&quot;</span><span class="p">),</span>
</span><span data-line="7">    <span class="n">Proxy</span><span class="p">(</span>
</span><span data-line="8">        <span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://proxy3.example.com:8080&quot;</span><span class="p">,</span>
</span><span data-line="9">        <span class="n">username</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;demo&quot;</span><span class="p">),</span>
</span><span data-line="10">        <span class="n">password</span><span class="o">=</span><span class="n">SecretStr</span><span class="p">(</span><span class="s2">&quot;pass&quot;</span><span class="p">),</span>
</span><span data-line="11">    <span class="p">),</span>
</span><span data-line="12"><span class="p">]</span>
</span><span data-line="13">
</span><span data-line="14"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>  <span class="c1"># round-robin by default</span>
</span><span data-line="15"><span class="n">response</span> <span class="o">=</span> <span class="n">rotator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://httpbin.org/ip&quot;</span><span class="p">)</span>
</span><span data-line="16"><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Need a larger pool? Use <code class="xref py py-class docutils literal notranslate"><span class="pre">proxywhirl.ProxyFetcher</span></code> with <code class="xref py py-data docutils literal notranslate"><span class="pre">proxywhirl.RECOMMENDED_SOURCES</span></code> to hydrate your rotator, then call <code class="xref py py-func docutils literal notranslate"><span class="pre">proxywhirl.deduplicate_proxies()</span></code> before adding user-supplied proxies.</p>
</div>
</section>
<hr class="docutils" />
<section id="decision-matrix">
<h2>Decision Matrix<a class="headerlink" href="#decision-matrix" title="Link to this heading">¶</a></h2>
<p>Use this table to pick the right strategy for your workload:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 16.0%" />
<col style="width: 20.0%" />
<col style="width: 14.0%" />
<col style="width: 14.0%" />
<col style="width: 36.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Strategy</p></th>
<th class="head"><p>Ideal For</p></th>
<th class="head"><p>Latency</p></th>
<th class="head"><p>Thread-Safe</p></th>
<th class="head"><p>Highlights</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">round-robin</span></code></p></td>
<td><p>Fair distribution, predictable workloads</p></td>
<td><p>~3 us</p></td>
<td><p>Lock-based</p></td>
<td><p>+/-1 request variance; deterministic ordering</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">random</span></code></p></td>
<td><p>Load testing, rate-limit avoidance</p></td>
<td><p>~7 us</p></td>
<td><p>GIL-safe</p></td>
<td><p>Natural jitter masks access patterns</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">weighted</span></code></p></td>
<td><p>Premium proxies, health-based routing</p></td>
<td><p>~9 us</p></td>
<td><p>Lock-based</p></td>
<td><p>Custom weights or auto-derived from success rate</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">least-used</span></code></p></td>
<td><p>Long-running jobs, even balancing</p></td>
<td><p>~3 us</p></td>
<td><p>Lock-based</p></td>
<td><p>Min-heap tracks request totals</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">performance-based</span></code></p></td>
<td><p>Speed-critical scraping</p></td>
<td><p>~12 us</p></td>
<td><p>GIL-safe</p></td>
<td><p>EMA smoothing of response times (configurable alpha)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">session-persistence</span></code></p></td>
<td><p>Stateful APIs, cookie-dependent flows</p></td>
<td><p>~5 us</p></td>
<td><p>Lock-based</p></td>
<td><p>Maps session keys to proxy IDs with TTL</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">geo-targeted</span></code></p></td>
<td><p>Geo-specific content, localization QA</p></td>
<td><p>~8 us</p></td>
<td><p>Stateless</p></td>
<td><p>Filters by country code from proxy metadata</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost-aware</span></code></p></td>
<td><p>Budget-constrained environments</p></td>
<td><p>~10 us</p></td>
<td><p>GIL-safe</p></td>
<td><p>Favors free proxies with configurable cost ceiling</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">composite</span></code></p></td>
<td><p>Complex multi-criteria selection</p></td>
<td><p>varies</p></td>
<td><p>Inherited</p></td>
<td><p>Chains filter + select strategies in a pipeline</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All strategies implement the <code class="xref py py-class docutils literal notranslate"><span class="pre">RotationStrategy</span></code> protocol, which requires two methods: <code class="docutils literal notranslate"><span class="pre">select(pool,</span> <span class="pre">context)</span></code> and <code class="docutils literal notranslate"><span class="pre">record_result(proxy,</span> <span class="pre">success,</span> <span class="pre">response_time_ms)</span></code>.</p>
</div>
</section>
<hr class="docutils" />
<section id="quick-pick-guide">
<h2>Quick-Pick Guide<a class="headerlink" href="#quick-pick-guide" title="Link to this heading">¶</a></h2>
<p>Not sure which strategy to use? Follow this decision tree:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Question</p></th>
<th class="head"><p>Yes</p></th>
<th class="head"><p>No</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Need sticky sessions for stateful APIs?</p></td>
<td><p><strong>session-persistence</strong></p></td>
<td><p>Continue</p></td>
</tr>
<tr class="row-odd"><td><p>Need proxies from a specific country?</p></td>
<td><p><strong>geo-targeted</strong></p></td>
<td><p>Continue</p></td>
</tr>
<tr class="row-even"><td><p>Need to minimize proxy costs?</p></td>
<td><p><strong>cost-aware</strong></p></td>
<td><p>Continue</p></td>
</tr>
<tr class="row-odd"><td><p>Is latency more important than fairness?</p></td>
<td><p><strong>performance-based</strong></p></td>
<td><p>Continue</p></td>
</tr>
<tr class="row-even"><td><p>Want to avoid detectable rotation patterns?</p></td>
<td><p><strong>random</strong></p></td>
<td><p>Continue</p></td>
</tr>
<tr class="row-odd"><td><p>Running a long crawl needing even distribution?</p></td>
<td><p><strong>least-used</strong></p></td>
<td><p>Continue</p></td>
</tr>
<tr class="row-even"><td><p>Have premium proxies that deserve more traffic?</p></td>
<td><p><strong>weighted</strong></p></td>
<td><p>Continue</p></td>
</tr>
<tr class="row-odd"><td><p>Need multiple criteria (e.g., geo + speed)?</p></td>
<td><p><strong>composite</strong></p></td>
<td><p><strong>round-robin</strong> (default)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="strategy-reference">
<h2>Strategy Reference<a class="headerlink" href="#strategy-reference" title="Link to this heading">¶</a></h2>
<section id="round-robin">
<h3>1. Round-Robin<a class="headerlink" href="#round-robin" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">RoundRobinStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;round-robin&quot;</span></code></p>
<p>Cycles through healthy proxies sequentially: A -&gt; B -&gt; C -&gt; A. The default strategy.</p>
<p><strong>Constructor:</strong> <code class="docutils literal notranslate"><span class="pre">RoundRobinStrategy()</span></code> – no parameters.</p>
<p><strong>When to use:</strong> Predictable workloads where even distribution matters more than performance optimization.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProxyWhirl</span><span class="p">,</span> <span class="n">Proxy</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">proxies</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="4">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://proxy1.example.com:8080&quot;</span><span class="p">),</span>
</span><span data-line="5">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://proxy2.example.com:8080&quot;</span><span class="p">),</span>
</span><span data-line="6">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://proxy3.example.com:8080&quot;</span><span class="p">),</span>
</span><span data-line="7"><span class="p">]</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># By name (simplest)</span>
</span><span data-line="10"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;round-robin&quot;</span><span class="p">)</span>
</span><span data-line="11"><span class="n">rotator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://example.com&quot;</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Or by instance (equivalent)</span>
</span><span data-line="14"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoundRobinStrategy</span>
</span><span data-line="15"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">RoundRobinStrategy</span><span class="p">())</span>
</span></pre></div>
</div>
</section>
<hr class="docutils" />
<section id="random">
<h3>2. Random<a class="headerlink" href="#random" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code></p>
<p>Picks a random healthy proxy for each request. No state to track.</p>
<p><strong>Constructor:</strong> <code class="docutils literal notranslate"><span class="pre">RandomStrategy()</span></code> – no parameters.</p>
<p><strong>When to use:</strong> Rate-limit avoidance, load testing, or when you want unpredictable access patterns.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">)</span>
</span><span data-line="2"><span class="n">rotator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://api.example.com/data&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<hr class="docutils" />
<section id="weighted">
<h3>3. Weighted<a class="headerlink" href="#weighted" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">WeightedStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;weighted&quot;</span></code></p>
<p>Selects proxies using weighted random sampling. Weights can be set explicitly or are auto-derived from each proxy’s success rate. Every proxy gets a minimum weight of <code class="docutils literal notranslate"><span class="pre">0.1</span></code> to prevent starvation.</p>
<p><strong>Constructor:</strong> <code class="docutils literal notranslate"><span class="pre">WeightedStrategy()</span></code> – no parameters. Configure via <code class="xref py py-class docutils literal notranslate"><span class="pre">StrategyConfig</span></code>.</p>
<p><strong>When to use:</strong> When you have premium/reliable proxies that should receive more traffic, or want health-based load balancing.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
Auto weights (success rate)</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Weights are automatically derived from proxy success rates</span>
</span><span data-line="2"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
Custom weights</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">WeightedStrategy</span><span class="p">,</span> <span class="n">StrategyConfig</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">config</span> <span class="o">=</span> <span class="n">StrategyConfig</span><span class="p">(</span>
</span><span data-line="4">    <span class="n">weights</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="5">        <span class="s2">&quot;http://proxy1.example.com:8080&quot;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span>
</span><span data-line="6">        <span class="s2">&quot;http://proxy2.example.com:8080&quot;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span>
</span><span data-line="7">        <span class="s2">&quot;http://proxy3.example.com:8080&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
</span><span data-line="8">    <span class="p">}</span>
</span><span data-line="9"><span class="p">)</span>
</span><span data-line="10"><span class="n">strategy</span> <span class="o">=</span> <span class="n">WeightedStrategy</span><span class="p">()</span>
</span><span data-line="11"><span class="n">strategy</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="least-used">
<h3>4. Least-Used<a class="headerlink" href="#least-used" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">LeastUsedStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;least-used&quot;</span></code></p>
<p>Selects the proxy with the fewest total requests using a min-heap for O(log n) selection. The heap is lazily rebuilt when the pool changes.</p>
<p><strong>Constructor:</strong> <code class="docutils literal notranslate"><span class="pre">LeastUsedStrategy()</span></code> – no parameters.</p>
<p><strong>When to use:</strong> Long-running crawls that need even utilization across all proxies.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;least-used&quot;</span><span class="p">)</span>
</span><span data-line="2"><span class="n">rotator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://httpbin.org/ip&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<hr class="docutils" />
<section id="performance-based">
<h3>5. Performance-Based<a class="headerlink" href="#performance-based" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">PerformanceBasedStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;performance-based&quot;</span></code></p>
<p>Ranks proxies by inverse EMA (Exponential Moving Average) of response times – faster proxies get higher selection probability. New proxies without enough data receive “exploration trials” before performance scoring kicks in.</p>
<p><strong>Constructor parameters:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exploration_count</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p>Minimum trials for new proxies before performance-based selection applies. Set to <code class="docutils literal notranslate"><span class="pre">0</span></code> to disable exploration.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>When to use:</strong> Speed-critical scraping or API calls where latency matters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProxyWhirl</span><span class="p">,</span> <span class="n">PerformanceBasedStrategy</span><span class="p">,</span> <span class="n">StrategyConfig</span>
</span><span data-line="2">
</span><span data-line="3"><span class="c1"># Default: 5 exploration trials per new proxy</span>
</span><span data-line="4"><span class="n">strategy</span> <span class="o">=</span> <span class="n">PerformanceBasedStrategy</span><span class="p">()</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># Or tune exploration and EMA alpha</span>
</span><span data-line="7"><span class="n">strategy</span> <span class="o">=</span> <span class="n">PerformanceBasedStrategy</span><span class="p">(</span><span class="n">exploration_count</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span><span data-line="8"><span class="n">config</span> <span class="o">=</span> <span class="n">StrategyConfig</span><span class="p">(</span><span class="n">ema_alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>  <span class="c1"># Higher alpha = react faster to recent times</span>
</span><span data-line="9"><span class="n">strategy</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ema_alpha</span></code> parameter controls how quickly the strategy adapts to performance changes. Values closer to <code class="docutils literal notranslate"><span class="pre">1.0</span></code> weight recent observations heavily (reacts fast, noisy). Values closer to <code class="docutils literal notranslate"><span class="pre">0.0</span></code> smooth over longer history (reacts slowly, stable). Default is <code class="docutils literal notranslate"><span class="pre">0.2</span></code>.</p>
</div>
</section>
<hr class="docutils" />
<section id="session-persistence">
<h3>6. Session Persistence<a class="headerlink" href="#session-persistence" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">SessionPersistenceStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;session-persistence&quot;</span></code></p>
<p>Maps session IDs to specific proxies so that repeated requests with the same <code class="docutils literal notranslate"><span class="pre">session_id</span></code> always route through the same proxy. If the assigned proxy becomes unhealthy, the session automatically fails over to a new proxy.</p>
<p><strong>Constructor parameters:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">max_sessions</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10000</span></code></p></td>
<td><p>Maximum concurrent sessions before LRU eviction</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">auto_cleanup_threshold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
<td><p>Operations between automatic expired-session cleanup</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>When to use:</strong> Stateful APIs, cookie-dependent flows, or any workflow where a user/session must consistently use the same proxy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProxyWhirl</span><span class="p">,</span> <span class="n">SessionPersistenceStrategy</span><span class="p">,</span> <span class="n">SelectionContext</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">strategy</span> <span class="o">=</span> <span class="n">SessionPersistenceStrategy</span><span class="p">(</span><span class="n">max_sessions</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</span><span data-line="4"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># Select a proxy bound to a session key</span>
</span><span data-line="7"><span class="n">context</span> <span class="o">=</span> <span class="n">SelectionContext</span><span class="p">(</span><span class="n">session_id</span><span class="o">=</span><span class="s2">&quot;user-12345&quot;</span><span class="p">)</span>
</span><span data-line="8"><span class="n">proxy</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rotator</span><span class="o">.</span><span class="n">pool</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</span><span data-line="9"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Session bound to proxy: </span><span class="si">{</span><span class="n">proxy</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Make requests -- the rotator uses the strategy internally</span>
</span><span data-line="12"><span class="n">response</span> <span class="o">=</span> <span class="n">rotator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://api.example.com/profile&quot;</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Later selections with the same session_id return the same proxy</span>
</span><span data-line="15"><span class="n">proxy_again</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rotator</span><span class="o">.</span><span class="n">pool</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</span><span data-line="16"><span class="k">assert</span> <span class="n">proxy</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">proxy_again</span><span class="o">.</span><span class="n">id</span>  <span class="c1"># Same proxy for same session</span>
</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sessions expire after 1 hour by default. Configure via <code class="xref py py-class docutils literal notranslate"><span class="pre">StrategyConfig</span></code> with <code class="docutils literal notranslate"><span class="pre">session_stickiness_duration_seconds</span></code>.</p>
</div>
</section>
<hr class="docutils" />
<section id="geo-targeted">
<h3>7. Geo-Targeted<a class="headerlink" href="#geo-targeted" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">GeoTargetedStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;geo-targeted&quot;</span></code></p>
<p>Filters the proxy pool by geographic location (country or region) specified in the <code class="docutils literal notranslate"><span class="pre">SelectionContext</span></code>. Falls back to any healthy proxy when no match is found (configurable).</p>
<p><strong>Constructor:</strong> <code class="docutils literal notranslate"><span class="pre">GeoTargetedStrategy()</span></code> – no parameters. Configure via <code class="xref py py-class docutils literal notranslate"><span class="pre">StrategyConfig</span></code>.</p>
<p><strong>When to use:</strong> Geo-specific content scraping, localization QA, region-locked API access.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProxyWhirl</span><span class="p">,</span> <span class="n">GeoTargetedStrategy</span><span class="p">,</span> <span class="n">SelectionContext</span><span class="p">,</span> <span class="n">Proxy</span>
</span><span data-line="2">
</span><span data-line="3"><span class="c1"># Proxies with geo metadata</span>
</span><span data-line="4"><span class="n">proxies</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="5">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://us-proxy.example.com:8080&quot;</span><span class="p">,</span> <span class="n">country_code</span><span class="o">=</span><span class="s2">&quot;US&quot;</span><span class="p">),</span>
</span><span data-line="6">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://gb-proxy.example.com:8080&quot;</span><span class="p">,</span> <span class="n">country_code</span><span class="o">=</span><span class="s2">&quot;GB&quot;</span><span class="p">),</span>
</span><span data-line="7">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://de-proxy.example.com:8080&quot;</span><span class="p">,</span> <span class="n">country_code</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">),</span>
</span><span data-line="8"><span class="p">]</span>
</span><span data-line="9">
</span><span data-line="10"><span class="n">strategy</span> <span class="o">=</span> <span class="n">GeoTargetedStrategy</span><span class="p">()</span>
</span><span data-line="11"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Select a US-based proxy using the strategy directly</span>
</span><span data-line="14"><span class="n">context</span> <span class="o">=</span> <span class="n">SelectionContext</span><span class="p">(</span><span class="n">target_country</span><span class="o">=</span><span class="s2">&quot;US&quot;</span><span class="p">)</span>
</span><span data-line="15"><span class="n">proxy</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rotator</span><span class="o">.</span><span class="n">pool</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</span><span data-line="16"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected US proxy: </span><span class="si">{</span><span class="n">proxy</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">proxy</span><span class="o">.</span><span class="n">country_code</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Make requests -- the rotator handles proxy selection internally</span>
</span><span data-line="19"><span class="n">response</span> <span class="o">=</span> <span class="n">rotator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://api.example.com/local&quot;</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="c1"># Or target by region</span>
</span><span data-line="22"><span class="n">context</span> <span class="o">=</span> <span class="n">SelectionContext</span><span class="p">(</span><span class="n">target_region</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">)</span>
</span><span data-line="23"><span class="n">proxy</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rotator</span><span class="o">.</span><span class="n">pool</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</span><span data-line="24"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected European proxy: </span><span class="si">{</span><span class="n">proxy</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Country codes use ISO 3166-1 alpha-2 format (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;US&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;GB&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;DE&quot;</span></code>). Enrich proxies with geo data using <code class="docutils literal notranslate"><span class="pre">proxywhirl</span> <span class="pre">setup-geoip</span></code> or set <code class="docutils literal notranslate"><span class="pre">country_code</span></code> directly on the <code class="xref py py-class docutils literal notranslate"><span class="pre">Proxy</span></code> model.</p>
</div>
<p><strong>Configuration options</strong> via <code class="xref py py-class docutils literal notranslate"><span class="pre">StrategyConfig</span></code>:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config Field</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">geo_fallback_enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Fall back to any proxy when no geo match found</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">geo_secondary_strategy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;round_robin&quot;</span></code></p></td>
<td><p>Strategy for selecting from geo-filtered proxies (<code class="docutils literal notranslate"><span class="pre">&quot;round_robin&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;least_used&quot;</span></code>)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="cost-aware">
<h3>8. Cost-Aware<a class="headerlink" href="#cost-aware" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">CostAwareStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;cost-aware&quot;</span></code></p>
<p>Prioritizes free proxies over paid ones using inverse-cost weighted random selection. Free proxies receive a configurable boost multiplier (default 10x).</p>
<p><strong>Constructor parameters:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">max_cost_per_request</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Maximum acceptable cost per request. Proxies exceeding this cost are filtered out. <code class="docutils literal notranslate"><span class="pre">None</span></code> means no limit.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>When to use:</strong> Budget-constrained environments where you mix free and paid proxies.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProxyWhirl</span><span class="p">,</span> <span class="n">CostAwareStrategy</span><span class="p">,</span> <span class="n">StrategyConfig</span><span class="p">,</span> <span class="n">Proxy</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">proxies</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="4">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://free-proxy.example.com:8080&quot;</span><span class="p">,</span> <span class="n">cost_per_request</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
</span><span data-line="5">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://cheap-proxy.example.com:8080&quot;</span><span class="p">,</span> <span class="n">cost_per_request</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
</span><span data-line="6">    <span class="n">Proxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://premium-proxy.example.com:8080&quot;</span><span class="p">,</span> <span class="n">cost_per_request</span><span class="o">=</span><span class="mf">0.10</span><span class="p">),</span>
</span><span data-line="7"><span class="p">]</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># Basic: favor free proxies</span>
</span><span data-line="10"><span class="n">strategy</span> <span class="o">=</span> <span class="n">CostAwareStrategy</span><span class="p">()</span>
</span><span data-line="11"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># With cost ceiling: exclude expensive proxies</span>
</span><span data-line="14"><span class="n">strategy</span> <span class="o">=</span> <span class="n">CostAwareStrategy</span><span class="p">(</span><span class="n">max_cost_per_request</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</span><span data-line="15"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Configuration options</strong> via <code class="xref py py-class docutils literal notranslate"><span class="pre">StrategyConfig</span></code> metadata:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Metadata Key</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">max_cost_per_request</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Maximum cost threshold (overrides constructor)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">free_proxy_boost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10.0</span></code></p></td>
<td><p>Weight multiplier for free proxies</p></td>
</tr>
</tbody>
</table>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">config</span> <span class="o">=</span> <span class="n">StrategyConfig</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="2">    <span class="s2">&quot;max_cost_per_request&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
</span><span data-line="3">    <span class="s2">&quot;free_proxy_boost&quot;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
</span><span data-line="4"><span class="p">})</span>
</span><span data-line="5"><span class="n">strategy</span> <span class="o">=</span> <span class="n">CostAwareStrategy</span><span class="p">()</span>
</span><span data-line="6"><span class="n">strategy</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<hr class="docutils" />
<section id="composite">
<h3>9. Composite<a class="headerlink" href="#composite" title="Link to this heading">¶</a></h3>
<p><strong>Class:</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">CompositeStrategy</span></code> | <strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;composite&quot;</span></code></p>
<p>Chains multiple strategies into a pipeline: <strong>filter</strong> strategies narrow the pool, then a <strong>selector</strong> strategy makes the final pick.</p>
<p><strong>Constructor parameters:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">filters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">list[RotationStrategy]</span> <span class="pre">|</span> <span class="pre">None</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[]</span></code></p></td>
<td><p>Strategies that filter the proxy pool sequentially</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">selector</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RotationStrategy</span> <span class="pre">|</span> <span class="pre">None</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RoundRobinStrategy()</span></code></p></td>
<td><p>Strategy that selects from the filtered pool</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>When to use:</strong> Complex selection criteria that require multiple stages (e.g., “from US proxies, pick the fastest”).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span data-line="2">    <span class="n">ProxyWhirl</span><span class="p">,</span>
</span><span data-line="3">    <span class="n">CompositeStrategy</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">GeoTargetedStrategy</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">PerformanceBasedStrategy</span><span class="p">,</span>
</span><span data-line="6">    <span class="n">SelectionContext</span><span class="p">,</span>
</span><span data-line="7"><span class="p">)</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># Filter by geography, then select by performance</span>
</span><span data-line="10"><span class="n">strategy</span> <span class="o">=</span> <span class="n">CompositeStrategy</span><span class="p">(</span>
</span><span data-line="11">    <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">GeoTargetedStrategy</span><span class="p">()],</span>
</span><span data-line="12">    <span class="n">selector</span><span class="o">=</span><span class="n">PerformanceBasedStrategy</span><span class="p">(),</span>
</span><span data-line="13"><span class="p">)</span>
</span><span data-line="14"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
</span><span data-line="15">
</span><span data-line="16"><span class="c1"># Select a proxy: geo-filter to US, then pick the fastest</span>
</span><span data-line="17"><span class="n">context</span> <span class="o">=</span> <span class="n">SelectionContext</span><span class="p">(</span><span class="n">target_country</span><span class="o">=</span><span class="s2">&quot;US&quot;</span><span class="p">)</span>
</span><span data-line="18"><span class="n">proxy</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rotator</span><span class="o">.</span><span class="n">pool</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</span><span data-line="19"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected fastest US proxy: </span><span class="si">{</span><span class="n">proxy</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="c1"># Make the request</span>
</span><span data-line="22"><span class="n">response</span> <span class="o">=</span> <span class="n">rotator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://api.example.com/data&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>You can also build composites from config dicts:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">strategy</span> <span class="o">=</span> <span class="n">CompositeStrategy</span><span class="o">.</span><span class="n">from_config</span><span class="p">({</span>
</span><span data-line="2">    <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;geo-targeted&quot;</span><span class="p">],</span>
</span><span data-line="3">    <span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;performance-based&quot;</span><span class="p">,</span>
</span><span data-line="4"><span class="p">})</span>
</span></pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="comparison-at-a-glance">
<h2>Comparison At a Glance<a class="headerlink" href="#comparison-at-a-glance" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 18.0%" />
<col style="width: 14.0%" />
<col style="width: 14.0%" />
<col style="width: 14.0%" />
<col style="width: 14.0%" />
<col style="width: 26.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Strategy</p></th>
<th class="head"><p>State</p></th>
<th class="head"><p>Context Needed</p></th>
<th class="head"><p>Metadata Needed</p></th>
<th class="head"><p>Complexity</p></th>
<th class="head"><p>Best Scenario</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Round-Robin</p></td>
<td><p>Index counter</p></td>
<td><p>No</p></td>
<td><p>None</p></td>
<td><p>O(1)</p></td>
<td><p>Default, even distribution</p></td>
</tr>
<tr class="row-odd"><td><p>Random</p></td>
<td><p>None</p></td>
<td><p>No</p></td>
<td><p>None</p></td>
<td><p>O(1)</p></td>
<td><p>Anti-pattern masking</p></td>
</tr>
<tr class="row-even"><td><p>Weighted</p></td>
<td><p>Weight cache</p></td>
<td><p>No</p></td>
<td><p>Weights (optional)</p></td>
<td><p>O(n)</p></td>
<td><p>Premium proxy prioritization</p></td>
</tr>
<tr class="row-odd"><td><p>Least-Used</p></td>
<td><p>Min-heap</p></td>
<td><p>No</p></td>
<td><p>None</p></td>
<td><p>O(log n)</p></td>
<td><p>Long crawls</p></td>
</tr>
<tr class="row-even"><td><p>Performance</p></td>
<td><p>EMA scores</p></td>
<td><p>No</p></td>
<td><p>None (auto-built)</p></td>
<td><p>O(n)</p></td>
<td><p>Latency-sensitive</p></td>
</tr>
<tr class="row-odd"><td><p>Session</p></td>
<td><p>Session map</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">session_id</span></code></p></td>
<td><p>None</p></td>
<td><p>O(1) lookup</p></td>
<td><p>Stateful APIs</p></td>
</tr>
<tr class="row-even"><td><p>Geo-Targeted</p></td>
<td><p>None</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">target_country</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">country_code</span></code></p></td>
<td><p>O(n) filter</p></td>
<td><p>Region-locked content</p></td>
</tr>
<tr class="row-odd"><td><p>Cost-Aware</p></td>
<td><p>None</p></td>
<td><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cost_per_request</span></code></p></td>
<td><p>O(n)</p></td>
<td><p>Budget optimization</p></td>
</tr>
<tr class="row-even"><td><p>Composite</p></td>
<td><p>Inherited</p></td>
<td><p>Varies</p></td>
<td><p>Varies</p></td>
<td><p>Sum of parts</p></td>
<td><p>Multi-criteria</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="hot-swapping-strategies">
<h2>Hot-Swapping Strategies<a class="headerlink" href="#hot-swapping-strategies" title="Link to this heading">¶</a></h2>
<p>Switch strategies at runtime without restarting:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;round-robin&quot;</span><span class="p">)</span>
</span><span data-line="2">
</span><span data-line="3"><span class="c1"># ... after observing proxy performance ...</span>
</span><span data-line="4">
</span><span data-line="5"><span class="c1"># Hot-swap to performance-based</span>
</span><span data-line="6"><span class="n">rotator</span><span class="o">.</span><span class="n">set_strategy</span><span class="p">(</span><span class="s2">&quot;performance-based&quot;</span><span class="p">)</span>
</span><span data-line="7">
</span><span data-line="8"><span class="c1"># Or swap to a custom-configured strategy</span>
</span><span data-line="9"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">WeightedStrategy</span><span class="p">,</span> <span class="n">StrategyConfig</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">strategy</span> <span class="o">=</span> <span class="n">WeightedStrategy</span><span class="p">()</span>
</span><span data-line="12"><span class="n">strategy</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">StrategyConfig</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="13">    <span class="s2">&quot;http://proxy1.example.com:8080&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
</span><span data-line="14">    <span class="s2">&quot;http://proxy2.example.com:8080&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
</span><span data-line="15"><span class="p">}))</span>
</span><span data-line="16"><span class="n">rotator</span><span class="o">.</span><span class="n">set_strategy</span><span class="p">(</span><span class="n">strategy</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Hot-swap is atomic and completes in &lt;100ms. In-flight requests finish with their original strategy; new requests immediately use the new one. Supported strategy names for <code class="docutils literal notranslate"><span class="pre">set_strategy()</span></code>: <code class="docutils literal notranslate"><span class="pre">&quot;round-robin&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;weighted&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;least-used&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;performance-based&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;session&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;geo-targeted&quot;</span></code>.</p>
</section>
<hr class="docutils" />
<section id="observe-the-pool">
<h2>Observe the Pool<a class="headerlink" href="#observe-the-pool" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">stats</span> <span class="o">=</span> <span class="n">rotator</span><span class="o">.</span><span class="n">get_pool_stats</span><span class="p">()</span>
</span><span data-line="2"><span class="nb">print</span><span class="p">(</span>
</span><span data-line="3">    <span class="sa">f</span><span class="s2">&quot;Total: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;total_proxies&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | &quot;</span>
</span><span data-line="4">    <span class="sa">f</span><span class="s2">&quot;Healthy: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;healthy_proxies&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | &quot;</span>
</span><span data-line="5">    <span class="sa">f</span><span class="s2">&quot;Average success: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;average_success_rate&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span data-line="6"><span class="p">)</span>
</span></pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">rotator.clear_unhealthy_proxies()</span></code> to evict failing endpoints during long-running crawls.</p>
<p>You can also monitor from the command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># One-shot health check</span>
</span><span data-line="2">uv<span class="w"> </span>run<span class="w"> </span>proxywhirl<span class="w"> </span>health
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Continuous monitoring every 60 seconds</span>
</span><span data-line="5">uv<span class="w"> </span>run<span class="w"> </span>proxywhirl<span class="w"> </span>health<span class="w"> </span>--continuous<span class="w"> </span>--interval<span class="w"> </span><span class="m">60</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Retry and circuit breaker statistics</span>
</span><span data-line="8">uv<span class="w"> </span>run<span class="w"> </span>proxywhirl<span class="w"> </span>stats<span class="w"> </span>--retry<span class="w"> </span>--circuit-breaker
</span></pre></div>
</div>
<p>See <a class="reference internal" href="../guides/cli-reference.html"><span class="doc">CLI Reference</span></a> for the full CLI reference.</p>
</section>
<hr class="docutils" />
<section id="building-a-custom-strategy">
<h2>Building a Custom Strategy<a class="headerlink" href="#building-a-custom-strategy" title="Link to this heading">¶</a></h2>
<p>Any class implementing the <code class="xref py py-class docutils literal notranslate"><span class="pre">RotationStrategy</span></code> protocol can be used as a strategy. The protocol requires two methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">Proxy</span><span class="p">,</span> <span class="n">ProxyPool</span><span class="p">,</span> <span class="n">SelectionContext</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProxyPoolEmptyError</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">class</span><span class="w"> </span><span class="nc">PriorityStrategy</span><span class="p">:</span>
</span><span data-line="5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Always selects the first healthy proxy (simple priority queue).&quot;&quot;&quot;</span>
</span><span data-line="6">
</span><span data-line="7">    <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool</span><span class="p">:</span> <span class="n">ProxyPool</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">SelectionContext</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Proxy</span><span class="p">:</span>
</span><span data-line="8">        <span class="n">healthy</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">get_healthy_proxies</span><span class="p">()</span>
</span><span data-line="9">        <span class="k">if</span> <span class="ow">not</span> <span class="n">healthy</span><span class="p">:</span>
</span><span data-line="10">            <span class="k">raise</span> <span class="n">ProxyPoolEmptyError</span><span class="p">(</span><span class="s2">&quot;No healthy proxies available&quot;</span><span class="p">)</span>
</span><span data-line="11">        <span class="k">return</span> <span class="n">healthy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span data-line="12">
</span><span data-line="13">    <span class="k">def</span><span class="w"> </span><span class="nf">record_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proxy</span><span class="p">:</span> <span class="n">Proxy</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">response_time_ms</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="14">        <span class="n">proxy</span><span class="o">.</span><span class="n">complete_request</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="n">success</span><span class="p">,</span> <span class="n">response_time_ms</span><span class="o">=</span><span class="n">response_time_ms</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Register it globally so other components can look it up by name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">proxywhirl</span><span class="w"> </span><span class="kn">import</span> <span class="n">StrategyRegistry</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">registry</span> <span class="o">=</span> <span class="n">StrategyRegistry</span><span class="p">()</span>
</span><span data-line="4"><span class="n">registry</span><span class="o">.</span><span class="n">register_strategy</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">,</span> <span class="n">PriorityStrategy</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># Retrieve later</span>
</span><span data-line="7"><span class="n">strategy_cls</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get_strategy</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">)</span>
</span><span data-line="8"><span class="n">rotator</span> <span class="o">=</span> <span class="n">ProxyWhirl</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy_cls</span><span class="p">())</span>
</span></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Custom strategies used in multi-threaded code must be thread-safe. Protect shared mutable state with <code class="docutils literal notranslate"><span class="pre">threading.Lock</span></code> or use <code class="xref py py-class docutils literal notranslate"><span class="pre">StrategyState</span></code> for per-proxy metrics tracking.</p>
</div>
</section>
<hr class="docutils" />
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../guides/advanced-strategies.html"><span class="doc">Advanced Rotation Strategies</span></a> – deep dive into composite pipelines and EMA tuning</p></li>
<li><p><a class="reference internal" href="../guides/retry-failover.html"><span class="doc">Retry &amp; Failover Guide</span></a> – circuit breakers and retry policies that work alongside strategies</p></li>
<li><p><a class="reference internal" href="../guides/async-client.html"><span class="doc">Async Client Guide</span></a> – async patterns with strategy selection</p></li>
<li><p><a class="reference internal" href="../reference/python-api.html"><span class="doc">Python API Reference</span></a> – complete API reference for all strategy classes</p></li>
</ul>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="index.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">Getting Started</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="../guides/index.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">Guides</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2026, Wyatt Walsh</p>
  
  <p>
    Made with
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials">
<a href="https://github.com/wyattowalsh/proxywhirl" aria-label="GitHub">
  <iconify-icon icon="simple-icons:github"></iconify-icon>
</a></div>
    </div>
  </div>
</footer>
      <script src="../_static/documentation_options.js?v=e259d695"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../_static/shibuya.js?v=cac61aee"></script></body>
</html>